{
  "class": {
    "name": "Word.CustomProperty",
    "package": "word",
    "extends": [
      "OfficeExtension.ClientObject"
    ],
    "api_set": {
      "name": "WordApi",
      "status": "1.3"
    },
    "description": "Represents a custom property.",
    "examples": [
      {
        "description": null,
        "usage_code": "// Link to full sample: https://raw.githubusercontent.com/OfficeDev/office-js-snippets/prod/samples/word/30-properties/read-write-custom-document-properties.yaml\n\nawait Word.run(async (context) => {\n    const properties: Word.CustomPropertyCollection = context.document.properties.customProperties;\n    properties.load(\"key,type,value\");\n\n    await context.sync();\n    for (let i = 0; i < properties.items.length; i++)\n        console.log(\"Property Name:\" + properties.items[i].key + \"; Type=\" + properties.items[i].type + \"; Property Value=\" + properties.items[i].value);\n});",
        "output_code": null
      }
    ]
  },
  "properties": [
    {
      "name": "context",
      "type": "RequestContext",
      "description": "The request context associated with the object. This connects the add-in's process to the Office host application's process.",
      "since": null,
      "examples": [
        {
          "description": "Access the request context from a custom property to verify the connection between the add-in and Word, then use it to load and read the custom property's value.",
          "usage_code": "await Word.run(async (context) => {\n    // Get a custom property from the document\n    const customProperty = context.document.properties.customProperties.getItemOrNullObject(\"ProjectName\");\n    \n    // Access the request context associated with the custom property\n    const propertyContext = customProperty.context;\n    \n    // Use the context to load the property's value\n    customProperty.load(\"key, value\");\n    await propertyContext.sync();\n    \n    // Check if the property exists and log its value\n    if (!customProperty.isNullObject) {\n        console.log(`Custom property '${customProperty.key}' has value: ${customProperty.value}`);\n    } else {\n        console.log(\"Custom property 'ProjectName' does not exist\");\n    }\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "key",
      "type": "string",
      "description": "Gets the key of the custom property.",
      "since": "WordApi 1.3",
      "examples": [
        {
          "description": "Retrieve and display the key of the first custom property in the document",
          "usage_code": "await Word.run(async (context) => {\n    const customProperties = context.document.properties.customProperties;\n    customProperties.load(\"items\");\n    \n    await context.sync();\n    \n    if (customProperties.items.length > 0) {\n        const firstProperty = customProperties.items[0];\n        firstProperty.load(\"key\");\n        \n        await context.sync();\n        \n        console.log(\"Custom property key: \" + firstProperty.key);\n    }\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "type",
      "type": "Word.DocumentPropertyType | \"String\" | \"Number\" | \"Date\" | \"Boolean\"",
      "description": "Gets the value type of the custom property. Possible values are: String, Number, Date, Boolean.",
      "since": "WordApi 1.3",
      "examples": [
        {
          "description": "Check the type of a custom property named \"ProjectID\" and display different messages based on whether it's a String, Number, Date, or Boolean type.",
          "usage_code": "await Word.run(async (context) => {\n    const customProperty = context.document.properties.customProperties.getItemOrNullObject(\"ProjectID\");\n    customProperty.load(\"type\");\n    \n    await context.sync();\n    \n    if (!customProperty.isNullObject) {\n        const propertyType = customProperty.type;\n        \n        switch (propertyType) {\n            case Word.DocumentPropertyType.string:\n            case \"String\":\n                console.log(\"ProjectID is a String type property\");\n                break;\n            case Word.DocumentPropertyType.number:\n            case \"Number\":\n                console.log(\"ProjectID is a Number type property\");\n                break;\n            case Word.DocumentPropertyType.date:\n            case \"Date\":\n                console.log(\"ProjectID is a Date type property\");\n                break;\n            case Word.DocumentPropertyType.boolean:\n            case \"Boolean\":\n                console.log(\"ProjectID is a Boolean type property\");\n                break;\n        }\n    } else {\n        console.log(\"ProjectID custom property does not exist\");\n    }\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "value",
      "type": "any",
      "description": "Specifies the value of the custom property. Note that even though Word on the web and the docx file format allow these properties to be arbitrarily long, the desktop version of Word will truncate string values to 255 16-bit chars (possibly creating invalid unicode by breaking up a surrogate pair).",
      "since": "WordApi 1.3",
      "examples": [
        {
          "description": "Set a custom document property named \"ProjectCode\" with the value \"ALPHA-2024\" to track project information in the Word document.",
          "usage_code": "await Word.run(async (context) => {\n    // Get the custom properties collection\n    const customProperties = context.document.properties.customProperties;\n    \n    // Add or update a custom property with a specific value\n    const projectCodeProperty = customProperties.add(\"ProjectCode\", \"ALPHA-2024\");\n    \n    // Load the value to verify\n    projectCodeProperty.load(\"value\");\n    \n    await context.sync();\n    \n    console.log(`Custom property value set to: ${projectCodeProperty.value}`);\n});",
          "output_code": null
        }
      ]
    }
  ],
  "methods": [
    {
      "name": "delete",
      "kind": "delete",
      "description": "Deletes the custom property.",
      "signatures": [
        {
          "params": [],
          "returns": {
            "type": "void",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Delete a custom property named \"ProjectCode\" from the document",
          "usage_code": "await Word.run(async (context) => {\n    // Get the custom properties collection\n    const properties = context.document.properties.customProperties;\n    \n    // Get the specific custom property by key\n    const projectCodeProperty = properties.getItem(\"ProjectCode\");\n    \n    // Delete the custom property\n    projectCodeProperty.delete();\n    \n    await context.sync();\n    \n    console.log(\"Custom property 'ProjectCode' has been deleted.\");\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "load",
      "kind": "load",
      "description": "Queues up a command to load the specified properties of the object. You must call `context.sync()` before reading the properties.",
      "signatures": [
        {
          "params": [
            {
              "name": "options",
              "type": "Word.Interfaces.CustomPropertyLoadOptions",
              "required": false,
              "description": "Provides options for which properties of the object to load."
            }
          ],
          "returns": {
            "type": "Word.CustomProperty",
            "description": null
          }
        },
        {
          "params": [
            {
              "name": "propertyNames",
              "type": "string | string[]",
              "required": false,
              "description": "A comma-delimited string or an array of strings that specify the properties to load."
            }
          ],
          "returns": {
            "type": "Word.CustomProperty",
            "description": null
          }
        },
        {
          "params": [
            {
              "name": "propertyNamesAndPaths",
              "type": "{ select?: string; expand?: string; }",
              "required": false,
              "description": "`propertyNamesAndPaths.select` is a comma-delimited string that specifies the properties to load, and `propertyNamesAndPaths.expand` is a comma-delimited string that specifies the navigation properties to load."
            }
          ],
          "returns": {
            "type": "Word.CustomProperty",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Load and display the value and type of a custom document property named \"ProjectCode\"",
          "usage_code": "await Word.run(async (context) => {\n    // Get the custom property by key\n    const customProperty = context.document.properties.customProperties.getItem(\"ProjectCode\");\n    \n    // Load the value and type properties\n    customProperty.load(\"value, type\");\n    \n    // Sync to execute the load command\n    await context.sync();\n    \n    // Display the loaded properties\n    console.log(`Property Value: ${customProperty.value}`);\n    console.log(`Property Type: ${customProperty.type}`);\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "set",
      "kind": "write",
      "description": "Sets multiple properties of an object at the same time. You can pass either a plain object with the appropriate properties, or another API object of the same type.",
      "signatures": [
        {
          "params": [
            {
              "name": "properties",
              "type": "Interfaces.CustomPropertyUpdateData",
              "required": true,
              "description": "A JavaScript object with properties that are structured isomorphically to the properties of the object on which the method is called."
            },
            {
              "name": "options",
              "type": "OfficeExtension.UpdateOptions",
              "required": false,
              "description": "Provides an option to suppress errors if the properties object tries to set any read-only properties."
            }
          ],
          "returns": {
            "type": "void",
            "description": null
          }
        },
        {
          "params": [
            {
              "name": "properties",
              "type": "Word.CustomProperty",
              "required": true,
              "description": null
            }
          ],
          "returns": {
            "type": "void",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Update multiple properties of a custom document property at once, setting both its value and type",
          "usage_code": "await Word.run(async (context) => {\n    // Get the custom property named \"ProjectStatus\"\n    const customProperty = context.document.properties.customProperties.getItemOrNullObject(\"ProjectStatus\");\n    \n    // Set multiple properties at once\n    customProperty.set({\n        value: \"In Progress\",\n        type: Word.DocumentPropertyType.string\n    });\n    \n    await context.sync();\n    console.log(\"Custom property updated successfully\");\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "toJSON",
      "kind": "serialize",
      "description": "Overrides the JavaScript `toJSON()` method in order to provide more useful output when an API object is passed to `JSON.stringify()`. (`JSON.stringify`, in turn, calls the `toJSON` method of the object that's passed to it.) Whereas the original `Word.CustomProperty` object is an API object, the `toJSON` method returns a plain JavaScript object (typed as `Word.Interfaces.CustomPropertyData`) that contains shallow copies of any loaded child properties from the original object.",
      "signatures": [
        {
          "params": [],
          "returns": {
            "type": "Word.Interfaces.CustomPropertyData",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Serialize a custom document property to JSON format for logging or external storage",
          "usage_code": "await Word.run(async (context) => {\n    // Get a custom property from the document\n    const customProperty = context.document.properties.customProperties.getItemOrNullObject(\"ProjectName\");\n    customProperty.load(\"key, type, value\");\n    \n    await context.sync();\n    \n    if (!customProperty.isNullObject) {\n        // Convert the custom property to a plain JavaScript object\n        const propertyData = customProperty.toJSON();\n        \n        // Now you can use the plain object for logging, storage, or transmission\n        console.log(\"Custom Property as JSON:\", JSON.stringify(propertyData, null, 2));\n        console.log(\"Property Key:\", propertyData.key);\n        console.log(\"Property Value:\", propertyData.value);\n        console.log(\"Property Type:\", propertyData.type);\n    }\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "track",
      "kind": "track",
      "description": "Track the object for automatic adjustment based on surrounding changes in the document. This call is a shorthand for [context.trackedObjects.add(thisObject)](/en-us/javascript/api/office/officeextension.clientrequestcontext#office-officeextension-clientrequestcontext-trackedobjects-member). If you're using this object across `.sync` calls and outside the sequential execution of a \".run\" batch, and get an \"InvalidObjectPath\" error when setting a property or invoking a method on the object, you need to add the object to the tracked object collection when the object was first created. If this object is part of a collection, you should also track the parent collection.",
      "signatures": [
        {
          "params": [],
          "returns": {
            "type": "Word.CustomProperty",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Track a custom property object across multiple sync calls to prevent \"InvalidObjectPath\" errors when accessing it after document changes",
          "usage_code": "await Word.run(async (context) => {\n    // Get a custom property\n    const customProperty = context.document.properties.customProperties.getItemOrNullObject(\"ProjectName\");\n    customProperty.load(\"key,value\");\n    await context.sync();\n    \n    // Track the object to use it across multiple sync calls\n    customProperty.track();\n    \n    // Make changes to the document\n    context.document.body.insertParagraph(\"New content\", Word.InsertLocation.end);\n    await context.sync();\n    \n    // Access the tracked custom property again without errors\n    console.log(`Custom property: ${customProperty.key} = ${customProperty.value}`);\n    \n    // Update the property value\n    customProperty.value = \"Updated Project\";\n    await context.sync();\n    \n    // Untrack when done\n    customProperty.untrack();\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "untrack",
      "kind": "untrack",
      "description": "Release the memory associated with this object, if it has previously been tracked. This call is shorthand for [context.trackedObjects.remove(thisObject)](/en-us/javascript/api/office/officeextension.clientrequestcontext#office-officeextension-clientrequestcontext-trackedobjects-member). Having many tracked objects slows down the host application, so please remember to free any objects you add, once you're done using them. You'll need to call `context.sync()` before the memory release takes effect.",
      "signatures": [
        {
          "params": [],
          "returns": {
            "type": "Word.CustomProperty",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Create a custom property, use it to store document metadata, then untrack it to free memory after the operation is complete.",
          "usage_code": "await Word.run(async (context) => {\n    // Add a custom property to the document\n    const customProperty = context.document.properties.customProperties.add(\"ProjectCode\", \"PRJ-2024-001\");\n    \n    // Track the object to work with it\n    customProperty.track();\n    \n    // Load and sync to ensure the property is created\n    customProperty.load(\"key,value\");\n    await context.sync();\n    \n    console.log(`Custom property created: ${customProperty.key} = ${customProperty.value}`);\n    \n    // Untrack the object to release memory after we're done using it\n    customProperty.untrack();\n    \n    // Sync to apply the memory release\n    await context.sync();\n});",
          "output_code": null
        }
      ]
    }
  ],
  "source": {
    "urls": [
      "https://docs.microsoft.com/en-us/javascript/api/word",
      "https://raw.githubusercontent.com/OfficeDev/office-js-snippets/prod/samples/word/30-properties/read-write-custom-document-properties.yaml"
    ]
  }
}
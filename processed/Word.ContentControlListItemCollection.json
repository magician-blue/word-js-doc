{
  "class": {
    "name": "Word.ContentControlListItemCollection",
    "package": "word",
    "extends": [
      "OfficeExtension.ClientObject"
    ],
    "api_set": {
      "name": "WordApi",
      "status": "1.9"
    },
    "description": "Contains a collection of [Word.ContentControlListItem](/en-us/javascript/api/word/word.contentcontrollistitem) objects that represent the items in a dropdown list or combo box content control.",
    "examples": [
      {
        "description": null,
        "usage_code": "// Link to full sample: https://raw.githubusercontent.com/OfficeDev/office-js-snippets/prod/samples/word/10-content-controls/insert-and-change-combo-box-content-control.yaml\n\n// Gets the list items from the first combo box content control found in the selection.\nawait Word.run(async (context) => {\n  const selectedRange: Word.Range = context.document.getSelection();\n  let selectedContentControl = selectedRange\n    .getContentControls({\n      types: [Word.ContentControlType.comboBox]\n    })\n    .getFirstOrNullObject();\n  selectedContentControl.load(\"id,comboBoxContentControl\");\n  await context.sync();\n\n  if (selectedContentControl.isNullObject) {\n    const parentContentControl: Word.ContentControl = selectedRange.parentContentControl;\n    parentContentControl.load(\"id,type,comboBoxContentControl\");\n    await context.sync();\n\n    if (parentContentControl.isNullObject || parentContentControl.type !== Word.ContentControlType.comboBox) {\n      console.warn(\"No combo box content control is currently selected.\");\n      return;\n    } else {\n      selectedContentControl = parentContentControl;\n    }\n  }\n\n  let selectedComboBox: Word.ComboBoxContentControl = selectedContentControl.comboBoxContentControl;\n  selectedComboBox.listItems.load(\"items\");\n  await context.sync();\n\n  const currentItems: Word.ContentControlListItemCollection = selectedComboBox.listItems;\n  console.log(`The list from the combo box content control with ID ${selectedContentControl.id}:`, currentItems);\n});",
        "output_code": null
      }
    ]
  },
  "properties": [
    {
      "name": "context",
      "type": "RequestContext",
      "description": "The request context associated with the object. This connects the add-in's process to the Office host application's process.",
      "since": null,
      "examples": [
        {
          "description": "Access the request context from a ContentControlListItemCollection to verify the connection to the Office host application before performing operations on dropdown list items.",
          "usage_code": "await Word.run(async (context) => {\n    // Get the first content control in the document\n    const contentControl = context.document.contentControls.getFirst();\n    contentControl.load(\"type\");\n    await context.sync();\n    \n    // Get the list items collection\n    const listItems = contentControl.listItems;\n    \n    // Access the request context from the collection\n    const itemsContext = listItems.context;\n    \n    // Verify the context is valid by using it to load properties\n    listItems.load(\"items\");\n    await itemsContext.sync();\n    \n    console.log(`Found ${listItems.items.length} items in the dropdown list`);\n    console.log(\"Request context is valid and connected to Office host\");\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "items",
      "type": "Word.ContentControlListItem[]",
      "description": "Gets the loaded child items in this collection.",
      "since": null,
      "examples": [
        {
          "description": "Display the text values of all items in a dropdown list content control to the console",
          "usage_code": "await Word.run(async (context) => {\n    // Get the first content control in the document\n    const contentControl = context.document.contentControls.getFirst();\n    contentControl.load(\"type\");\n    \n    // Get the list items collection\n    const listItems = contentControl.listItems;\n    listItems.load(\"items\");\n    \n    await context.sync();\n    \n    // Access the loaded items array\n    const itemsArray = listItems.items;\n    \n    // Display each item's text\n    for (let i = 0; i < itemsArray.length; i++) {\n        itemsArray[i].load(\"displayText\");\n    }\n    \n    await context.sync();\n    \n    itemsArray.forEach((item, index) => {\n        console.log(`Item ${index}: ${item.displayText}`);\n    });\n});",
          "output_code": null
        }
      ]
    }
  ],
  "methods": [
    {
      "name": "getFirst",
      "kind": "read",
      "description": "Gets the first list item in this collection. Throws an ItemNotFound error if this collection is empty.",
      "signatures": [
        {
          "params": [],
          "returns": {
            "type": "Word.ContentControlListItem",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Get and display the text of the first item in a dropdown list content control",
          "usage_code": "await Word.run(async (context) => {\n    // Get the first content control in the document (assuming it's a dropdown or combo box)\n    const contentControl = context.document.contentControls.getFirst();\n    contentControl.load(\"type\");\n    \n    // Get the list items collection\n    const listItems = contentControl.listItems;\n    \n    // Get the first list item\n    const firstItem = listItems.getFirst();\n    firstItem.load(\"displayText,value\");\n    \n    await context.sync();\n    \n    // Display the first item's properties\n    console.log(`First item display text: ${firstItem.displayText}`);\n    console.log(`First item value: ${firstItem.value}`);\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "getFirstOrNullObject",
      "kind": "read",
      "description": "Gets the first list item in this collection. If this collection is empty, then this method will return an object with its isNullObject property set to true. For further information, see [OrNullObject methods and properties](/en-us/office/dev/add-ins/develop/application-specific-api-model#ornullobject-methods-and-properties).",
      "signatures": [
        {
          "params": [],
          "returns": {
            "type": "Word.ContentControlListItem",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Check if a dropdown content control has any items and display the first item's text, or show a message if the list is empty.",
          "usage_code": "await Word.run(async (context) => {\n    // Get the first content control in the document\n    const contentControl = context.document.contentControls.getFirst();\n    contentControl.load(\"type\");\n    \n    await context.sync();\n    \n    // Ensure it's a dropdown or combo box\n    if (contentControl.type === Word.ContentControlType.dropDownList || \n        contentControl.type === Word.ContentControlType.comboBox) {\n        \n        // Get the first item or null if empty\n        const firstItem = contentControl.listItems.getFirstOrNullObject();\n        firstItem.load(\"isNullObject,displayText\");\n        \n        await context.sync();\n        \n        if (firstItem.isNullObject) {\n            console.log(\"The dropdown list is empty.\");\n        } else {\n            console.log(\"First item: \" + firstItem.displayText);\n        }\n    }\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "load",
      "kind": "load",
      "description": "Queues up a command to load the specified properties of the object. You must call context.sync() before reading the properties.",
      "signatures": [
        {
          "params": [
            {
              "name": "options",
              "type": "Word.Interfaces.ContentControlListItemCollectionLoadOptions & Word.Interfaces.CollectionLoadOptions",
              "required": false,
              "description": "Provides options for which properties of the object to load."
            }
          ],
          "returns": {
            "type": "Word.ContentControlListItemCollection",
            "description": null
          }
        },
        {
          "params": [
            {
              "name": "propertyNames",
              "type": "string | string[]",
              "required": false,
              "description": "A comma-delimited string or an array of strings that specify the properties to load."
            }
          ],
          "returns": {
            "type": "Word.ContentControlListItemCollection",
            "description": null
          }
        },
        {
          "params": [
            {
              "name": "propertyNamesAndPaths",
              "type": "OfficeExtension.LoadOption",
              "required": false,
              "description": "propertyNamesAndPaths.select is a comma-delimited string that specifies the properties to load, and propertyNamesAndPaths.expand is a comma-delimited string that specifies the navigation properties to load."
            }
          ],
          "returns": {
            "type": "Word.ContentControlListItemCollection",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Load and display the text values of all items in a dropdown list content control",
          "usage_code": "await Word.run(async (context) => {\n    // Get the first content control in the document\n    const contentControl = context.document.contentControls.getFirst();\n    \n    // Get the list items collection\n    const listItems = contentControl.listItems;\n    \n    // Load the 'value' and 'displayText' properties for all items\n    listItems.load(\"value, displayText\");\n    \n    await context.sync();\n    \n    // Display the loaded list items\n    console.log(`Found ${listItems.items.length} items in the dropdown:`);\n    listItems.items.forEach((item, index) => {\n        console.log(`Item ${index + 1}: ${item.displayText} (value: ${item.value})`);\n    });\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "toJSON",
      "kind": "serialize",
      "description": "Overrides the JavaScript toJSON() method in order to provide more useful output when an API object is passed to JSON.stringify(). (JSON.stringify, in turn, calls the toJSON method of the object that's passed to it.) Whereas the original Word.ContentControlListItemCollection object is an API object, the toJSON method returns a plain JavaScript object (typed as Word.Interfaces.ContentControlListItemCollectionData) that contains an \"items\" array with shallow copies of any loaded properties from the collection's items.",
      "signatures": [
        {
          "params": [],
          "returns": {
            "type": "Word.Interfaces.ContentControlListItemCollectionData",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Export dropdown list content control items to JSON format for logging or external storage",
          "usage_code": "await Word.run(async (context) => {\n    // Get the first content control in the document\n    const contentControls = context.document.contentControls;\n    contentControls.load(\"items\");\n    await context.sync();\n    \n    if (contentControls.items.length > 0) {\n        const dropdownControl = contentControls.items[0];\n        \n        // Get the list items collection\n        const listItems = dropdownControl.dropdownListItems;\n        listItems.load(\"displayText, value\");\n        await context.sync();\n        \n        // Convert the collection to a plain JavaScript object\n        const jsonData = listItems.toJSON();\n        \n        // Log or store the JSON representation\n        console.log(\"Dropdown items as JSON:\", JSON.stringify(jsonData, null, 2));\n        \n        // Access the items array from the JSON object\n        jsonData.items.forEach(item => {\n            console.log(`Display: ${item.displayText}, Value: ${item.value}`);\n        });\n    }\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "track",
      "kind": "track",
      "description": "Track the object for automatic adjustment based on surrounding changes in the document. This call is a shorthand for [context.trackedObjects.add(thisObject)](/en-us/javascript/api/office/officeextension.clientrequestcontext#office-officeextension-clientrequestcontext-trackedobjects-member). If you're using this object across .sync calls and outside the sequential execution of a \".run\" batch, and get an \"InvalidObjectPath\" error when setting a property or invoking a method on the object, you need to add the object to the tracked object collection when the object was first created. If this object is part of a collection, you should also track the parent collection.",
      "signatures": [
        {
          "params": [],
          "returns": {
            "type": "Word.ContentControlListItemCollection",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Track a dropdown content control's list items collection across multiple sync calls to safely access and modify items without getting \"InvalidObjectPath\" errors.",
          "usage_code": "await Word.run(async (context) => {\n    // Get the first content control (assumed to be a dropdown)\n    const contentControl = context.document.contentControls.getFirst();\n    const listItems = contentControl.dropdownListOrComboBoxListItems;\n    \n    // Track the collection to use it across multiple sync calls\n    listItems.track();\n    \n    // Load the items\n    listItems.load(\"items\");\n    await context.sync();\n    \n    // Now we can safely work with the collection after sync\n    console.log(`Found ${listItems.items.length} list items`);\n    \n    // Perform another sync and still access the collection\n    await context.sync();\n    \n    // Add a new item using the tracked collection\n    listItems.add(\"New Option\", \"newValue\");\n    \n    // Untrack when done to release memory\n    listItems.untrack();\n    \n    await context.sync();\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "untrack",
      "kind": "untrack",
      "description": "Release the memory associated with this object, if it has previously been tracked. This call is shorthand for [context.trackedObjects.remove(thisObject)](/en-us/javascript/api/office/officeextension.clientrequestcontext#office-officeextension-clientrequestcontext-trackedobjects-member). Having many tracked objects slows down the host application, so please remember to free any objects you add, once you're done using them. You'll need to call context.sync() before the memory release takes effect.",
      "signatures": [
        {
          "params": [],
          "returns": {
            "type": "Word.ContentControlListItemCollection",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Get the list items from a dropdown content control, process them, and then untrack the collection to free memory.",
          "usage_code": "await Word.run(async (context) => {\n    // Get the first content control in the document\n    const contentControl = context.document.contentControls.getFirst();\n    contentControl.load(\"type\");\n    \n    // Get the list items collection\n    const listItems = contentControl.listItems;\n    listItems.load(\"items\");\n    \n    await context.sync();\n    \n    // Process the list items (e.g., log their count)\n    console.log(`Found ${listItems.items.length} list items`);\n    \n    // Untrack the collection to release memory\n    listItems.untrack();\n    \n    await context.sync();\n});",
          "output_code": null
        }
      ]
    }
  ],
  "source": {
    "urls": [
      "https://docs.microsoft.com/en-us/javascript/api/word/word.contentcontrollistitemcollection"
    ]
  }
}
{
  "class": {
    "name": "LinkFormat",
    "package": "Word",
    "extends": [
      "OfficeExtension.ClientObject"
    ],
    "api_set": {
      "name": "WordApi",
      "status": "BETA (PREVIEW ONLY)"
    },
    "description": "Represents the linking characteristics for an OLE object or picture.",
    "examples": []
  },
  "properties": [
    {
      "name": "context",
      "type": "RequestContext",
      "description": "The request context associated with the object. This connects the add-in's process to the Office host application's process.",
      "since": "WordApi BETA (PREVIEW ONLY)",
      "examples": [
        {
          "description": "Access the LinkFormat's RequestContext to verify the connection between the add-in and Word before performing operations on a linked object.",
          "usage_code": "await Word.run(async (context) => {\n    // Get the first inline picture in the document\n    const firstPicture = context.document.body.inlinePictures.getFirst();\n    const linkFormat = firstPicture.linkFormat;\n    \n    // Access the RequestContext associated with the LinkFormat object\n    const linkContext = linkFormat.context;\n    \n    // Use the context to load properties and sync\n    linkFormat.load(\"isLinked\");\n    await linkContext.sync();\n    \n    console.log(\"LinkFormat context is connected to Word\");\n    console.log(`Picture is linked: ${linkFormat.isLinked}`);\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "isAutoUpdated",
      "type": "boolean",
      "description": "Specifies if the link is updated automatically when the container file is opened or when the source file is changed.",
      "since": "WordApi BETA (PREVIEW ONLY)",
      "examples": [
        {
          "description": "Check if a linked image in the document is set to auto-update and display the result in the console",
          "usage_code": "await Word.run(async (context) => {\n    // Get the first inline picture in the document\n    const firstPicture = context.document.body.inlinePictures.getFirstOrNullObject();\n    firstPicture.load(\"linkFormat\");\n    \n    await context.sync();\n    \n    if (!firstPicture.isNullObject) {\n        const linkFormat = firstPicture.linkFormat;\n        linkFormat.load(\"isAutoUpdated\");\n        \n        await context.sync();\n        \n        console.log(`Link is auto-updated: ${linkFormat.isAutoUpdated}`);\n    } else {\n        console.log(\"No pictures found in the document\");\n    }\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "isLocked",
      "type": "boolean",
      "description": "Specifies if a Field, InlineShape, or Shape object is locked to prevent automatic updating.",
      "since": "WordApi BETA (PREVIEW ONLY)",
      "examples": [
        {
          "description": "Lock a linked picture to prevent it from being automatically updated when the source file changes",
          "usage_code": "await Word.run(async (context) => {\n    // Get the first inline shape (picture) in the document\n    const inlineShape = context.document.body.inlineShapes.getFirst();\n    \n    // Load the linkFormat property\n    inlineShape.load(\"linkFormat\");\n    await context.sync();\n    \n    // Lock the linked picture to prevent automatic updates\n    if (inlineShape.linkFormat) {\n        inlineShape.linkFormat.isLocked = true;\n        await context.sync();\n        \n        console.log(\"Linked picture has been locked from automatic updates\");\n    }\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "isPictureSavedWithDocument",
      "type": "boolean",
      "description": "Specifies if the linked picture is saved with the document.",
      "since": "WordApi BETA (PREVIEW ONLY)",
      "examples": [
        {
          "description": "Check if a linked picture in the document is saved with the document and display the result in the console.",
          "usage_code": "await Word.run(async (context) => {\n    // Get the first inline picture in the document\n    const inlinePictures = context.document.body.inlinePictures;\n    inlinePictures.load(\"items\");\n    \n    await context.sync();\n    \n    if (inlinePictures.items.length > 0) {\n        const picture = inlinePictures.items[0];\n        const linkFormat = picture.linkFormat;\n        linkFormat.load(\"isPictureSavedWithDocument\");\n        \n        await context.sync();\n        \n        console.log(\"Is picture saved with document: \" + linkFormat.isPictureSavedWithDocument);\n    }\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "sourceFullName",
      "type": "string",
      "description": "Specifies the path and name of the source file for the linked OLE object, picture, or field.",
      "since": "WordApi BETA (PREVIEW ONLY)",
      "examples": [
        {
          "description": "Update the source file path of a linked image to point to a new location on the file system.",
          "usage_code": "await Word.run(async (context) => {\n    // Get the first inline picture in the document\n    const firstPicture = context.document.body.inlinePictures.getFirst();\n    \n    // Load the link format properties\n    firstPicture.load(\"linkFormat\");\n    await context.sync();\n    \n    // Update the source file path to a new location\n    firstPicture.linkFormat.sourceFullName = \"C:\\\\Images\\\\UpdatedLogo.png\";\n    \n    await context.sync();\n    \n    console.log(\"Source file path updated successfully\");\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "sourceName",
      "type": "string",
      "description": "Gets the name of the source file for the linked OLE object, picture, or field.",
      "since": "WordApi BETA (PREVIEW ONLY)",
      "examples": [
        {
          "description": "Get the source file name of a linked image in the document and display it in the console.",
          "usage_code": "await Word.run(async (context) => {\n    // Get the first inline picture in the document\n    const inlinePictures = context.document.body.inlinePictures;\n    inlinePictures.load(\"items\");\n    \n    await context.sync();\n    \n    if (inlinePictures.items.length > 0) {\n        const picture = inlinePictures.items[0];\n        \n        // Get the link format and source name\n        const linkFormat = picture.linkFormat;\n        linkFormat.load(\"sourceName\");\n        \n        await context.sync();\n        \n        // Display the source file name\n        console.log(\"Source file name: \" + linkFormat.sourceName);\n    } else {\n        console.log(\"No pictures found in the document.\");\n    }\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "sourcePath",
      "type": "string",
      "description": "Gets the path of the source file for the linked OLE object, picture, or field.",
      "since": "WordApi BETA (PREVIEW ONLY)",
      "examples": [
        {
          "description": "Get the source file path of a linked image in the document and display it in a content control.",
          "usage_code": "await Word.run(async (context) => {\n    // Get the first inline picture in the document\n    const pictures = context.document.body.inlinePictures;\n    pictures.load(\"items\");\n    \n    await context.sync();\n    \n    if (pictures.items.length > 0) {\n        const picture = pictures.items[0];\n        \n        // Get the link format and source path\n        const linkFormat = picture.linkFormat;\n        linkFormat.load(\"sourcePath\");\n        \n        await context.sync();\n        \n        // Display the source path\n        const sourcePath = linkFormat.sourcePath;\n        console.log(\"Linked image source path: \" + sourcePath);\n        \n        // Insert the path into the document\n        context.document.body.insertParagraph(\n            `Image source: ${sourcePath}`,\n            Word.InsertLocation.end\n        );\n    }\n    \n    await context.sync();\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "type",
      "type": "Word.LinkType | \"Ole\" | \"Picture\" | \"Text\" | \"Reference\" | \"Include\" | \"Import\" | \"Dde\" | \"DdeAuto\" | \"Chart\"",
      "description": "Gets the link type.",
      "since": "WordApi BETA (PREVIEW ONLY)",
      "examples": [
        {
          "description": "Check if a shape in the document contains a linked picture and display the link type",
          "usage_code": "await Word.run(async (context) => {\n    // Get the first inline shape in the document\n    const inlineShape = context.document.body.inlinePictures.getFirst();\n    \n    // Load the link format and its type property\n    inlineShape.load(\"linkFormat\");\n    const linkFormat = inlineShape.linkFormat;\n    linkFormat.load(\"type\");\n    \n    await context.sync();\n    \n    // Check and display the link type\n    console.log(\"Link type: \" + linkFormat.type);\n    \n    // Perform actions based on link type\n    if (linkFormat.type === Word.LinkType.picture || linkFormat.type === \"Picture\") {\n        console.log(\"This is a linked picture\");\n    } else if (linkFormat.type === Word.LinkType.ole || linkFormat.type === \"Ole\") {\n        console.log(\"This is an OLE object link\");\n    }\n});",
          "output_code": null
        }
      ]
    }
  ],
  "methods": [
    {
      "name": "breakLink",
      "kind": "delete",
      "description": "Breaks the link between the source file and the OLE object, picture, or linked field.",
      "signatures": [
        {
          "params": [],
          "returns": {
            "type": "void",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Break the link between a linked picture and its source file to embed it permanently in the document",
          "usage_code": "await Word.run(async (context) => {\n    // Get the first inline picture in the document\n    const firstPicture = context.document.body.inlinePictures.getFirst();\n    \n    // Load the linkFormat property\n    firstPicture.load(\"linkFormat\");\n    \n    await context.sync();\n    \n    // Break the link to the source file\n    firstPicture.linkFormat.breakLink();\n    \n    await context.sync();\n    \n    console.log(\"Link to source file has been broken. Picture is now embedded.\");\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "load",
      "kind": "load",
      "description": "Queues up a command to load the specified properties of the object. You must call context.sync() before reading the properties.",
      "signatures": [
        {
          "params": [
            {
              "name": "options",
              "type": "Word.Interfaces.LinkFormatLoadOptions",
              "required": false,
              "description": "Provides options for which properties of the object to load."
            }
          ],
          "returns": {
            "type": "Word.LinkFormat",
            "description": null
          }
        },
        {
          "params": [
            {
              "name": "propertyNames",
              "type": "string | string[]",
              "required": false,
              "description": "A comma-delimited string or an array of strings that specify the properties to load."
            }
          ],
          "returns": {
            "type": "Word.LinkFormat",
            "description": null
          }
        },
        {
          "params": [
            {
              "name": "propertyNamesAndPaths",
              "type": "{ select?: string; expand?: string; }",
              "required": false,
              "description": "propertyNamesAndPaths.select is a comma-delimited string that specifies the properties to load, and propertyNamesAndPaths.expand is a comma-delimited string that specifies the navigation properties to load."
            }
          ],
          "returns": {
            "type": "Word.LinkFormat",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Load and read the AutoUpdate property of a link format to check if an inline picture's link automatically updates",
          "usage_code": "await Word.run(async (context) => {\n    // Get the first inline picture in the document\n    const firstPicture = context.document.body.inlinePictures.getFirst();\n    \n    // Get the link format of the picture\n    const linkFormat = firstPicture.linkFormat;\n    \n    // Load the AutoUpdate property\n    linkFormat.load(\"autoUpdate\");\n    \n    // Sync to execute the load command\n    await context.sync();\n    \n    // Read the loaded property\n    console.log(\"Auto Update enabled: \" + linkFormat.autoUpdate);\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "set",
      "kind": "write",
      "description": "Sets multiple properties of an object at the same time. You can pass either a plain object with the appropriate properties, or another API object of the same type.",
      "signatures": [
        {
          "params": [
            {
              "name": "properties",
              "type": "Interfaces.LinkFormatUpdateData",
              "required": true,
              "description": "A JavaScript object with properties that are structured isomorphically to the properties of the object on which the method is called."
            },
            {
              "name": "options",
              "type": "OfficeExtension.UpdateOptions",
              "required": false,
              "description": "Provides an option to suppress errors if the properties object tries to set any read-only properties."
            }
          ],
          "returns": {
            "type": "void",
            "description": null
          }
        },
        {
          "params": [
            {
              "name": "properties",
              "type": "Word.LinkFormat",
              "required": true,
              "description": null
            }
          ],
          "returns": {
            "type": "void",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Configure multiple linking properties for a picture to make it auto-update and save the picture with the document",
          "usage_code": "await Word.run(async (context) => {\n    // Get the first inline picture in the document\n    const firstPicture = context.document.body.inlinePictures.getFirst();\n    \n    // Set multiple link format properties at once\n    firstPicture.linkFormat.set({\n        autoUpdate: true,\n        saveWithDocument: true\n    });\n    \n    await context.sync();\n    console.log(\"Link format properties updated successfully\");\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "toJSON",
      "kind": "serialize",
      "description": "Overrides the JavaScript toJSON() method in order to provide more useful output when an API object is passed to JSON.stringify(). (JSON.stringify, in turn, calls the toJSON method of the object that's passed to it.) Whereas the original Word.LinkFormat object is an API object, the toJSON method returns a plain JavaScript object (typed as Word.Interfaces.LinkFormatData) that contains shallow copies of any loaded child properties from the original object.",
      "signatures": [
        {
          "params": [],
          "returns": {
            "type": "Word.Interfaces.LinkFormatData",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Get the link format properties of the first inline picture in the document and output them as a JSON string to the console.",
          "usage_code": "await Word.run(async (context) => {\n    // Get the first inline picture in the document\n    const firstPicture = context.document.body.inlinePictures.getFirst();\n    \n    // Get the link format of the picture\n    const linkFormat = firstPicture.linkFormat;\n    \n    // Load the link format properties\n    linkFormat.load();\n    \n    await context.sync();\n    \n    // Convert the LinkFormat object to a plain JavaScript object\n    const linkFormatData = linkFormat.toJSON();\n    \n    // Output as JSON string\n    console.log(JSON.stringify(linkFormatData, null, 2));\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "track",
      "kind": "track",
      "description": "Track the object for automatic adjustment based on surrounding changes in the document. This call is a shorthand for context.trackedObjects.add(thisObject). If you're using this object across .sync calls and outside the sequential execution of a \".run\" batch, and get an \"InvalidObjectPath\" error when setting a property or invoking a method on the object, you need to add the object to the tracked object collection when the object was first created. If this object is part of a collection, you should also track the parent collection.",
      "signatures": [
        {
          "params": [],
          "returns": {
            "type": "Word.LinkFormat",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Track a LinkFormat object to maintain its reference across multiple sync calls when modifying linked object properties",
          "usage_code": "await Word.run(async (context) => {\n    // Get the first inline picture in the document\n    const firstPicture = context.document.body.inlinePictures.getFirst();\n    \n    // Get the LinkFormat object\n    const linkFormat = firstPicture.linkFormat;\n    \n    // Track the LinkFormat object for use across sync calls\n    linkFormat.track();\n    \n    // Load properties\n    linkFormat.load(\"isLinked\");\n    \n    await context.sync();\n    \n    // Now we can safely use the object across multiple syncs\n    console.log(\"Is linked: \" + linkFormat.isLinked);\n    \n    // Perform additional operations with the tracked object\n    await context.sync();\n    \n    // Untrack when done to release memory\n    linkFormat.untrack();\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "untrack",
      "kind": "untrack",
      "description": "Release the memory associated with this object, if it has previously been tracked. This call is shorthand for context.trackedObjects.remove(thisObject). Having many tracked objects slows down the host application, so please remember to free any objects you add, once you're done using them. You'll need to call context.sync() before the memory release takes effect.",
      "signatures": [
        {
          "params": [],
          "returns": {
            "type": "Word.LinkFormat",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Release memory for a tracked LinkFormat object after reading its properties to avoid slowing down the host application.",
          "usage_code": "await Word.run(async (context) => {\n    // Get the first inline picture in the document\n    const firstPicture = context.document.body.inlinePictures.getFirstOrNullObject();\n    const linkFormat = firstPicture.linkFormat;\n    \n    // Track the object to work with it\n    linkFormat.track();\n    \n    // Load properties to use\n    linkFormat.load(\"autoUpdate\");\n    await context.sync();\n    \n    // Use the linkFormat object\n    console.log(\"Auto update enabled: \" + linkFormat.autoUpdate);\n    \n    // Release the memory after we're done using it\n    linkFormat.untrack();\n    await context.sync();\n});",
          "output_code": null
        }
      ]
    }
  ],
  "source": {
    "urls": [
      "https://learn.microsoft.com/en-us/javascript/api/word"
    ]
  }
}
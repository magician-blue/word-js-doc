{
  "class": {
    "name": "Word.TrackedChangeCollection",
    "package": "word",
    "extends": [
      "OfficeExtension.ClientObject"
    ],
    "api_set": {
      "name": "WordApi",
      "status": "1.6"
    },
    "description": "Contains a collection of [Word.TrackedChange](/en-us/javascript/api/word/word.trackedchange) objects.",
    "examples": [
      {
        "description": null,
        "usage_code": "// Link to full sample: https://raw.githubusercontent.com/OfficeDev/office-js-snippets/prod/samples/word/50-document/manage-tracked-changes.yaml\n\n// Gets the range of the first tracked change.\nawait Word.run(async (context) => {\n  const body: Word.Body = context.document.body;\n  const trackedChanges: Word.TrackedChangeCollection = body.getTrackedChanges();\n  const trackedChange: Word.TrackedChange = trackedChanges.getFirst();\n  await context.sync();\n\n  const range: Word.Range = trackedChange.getRange();\n  range.load();\n  await context.sync();\n\n  console.log(\"range.text: \" + range.text);\n});",
        "output_code": null
      }
    ]
  },
  "properties": [
    {
      "name": "context",
      "type": "RequestContext",
      "description": "The request context associated with the object. This connects the add-in's process to the Office host application's process.",
      "since": null,
      "examples": [
        {
          "description": "Access the request context from a TrackedChangeCollection to verify the connection between the add-in and Word before processing tracked changes.",
          "usage_code": "await Word.run(async (context) => {\n    const trackedChanges = context.document.body.trackedChanges;\n    trackedChanges.load(\"items\");\n    await context.sync();\n    \n    // Access the request context from the collection\n    const requestContext = trackedChanges.context;\n    \n    // Verify the context is valid by checking if it matches the current context\n    if (requestContext === context) {\n        console.log(\"TrackedChangeCollection is properly connected to the Word context\");\n        console.log(`Found ${trackedChanges.items.length} tracked changes`);\n    }\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "items",
      "type": "Word.TrackedChange[]",
      "description": "Gets the loaded child items in this collection.",
      "since": null,
      "examples": [
        {
          "description": "Get all tracked changes in the document and log their text content to the console",
          "usage_code": "await Word.run(async (context) => {\n    // Get the tracked changes collection from the document\n    const trackedChanges = context.document.getTrackedChanges();\n    \n    // Load the items property to access the array of tracked changes\n    trackedChanges.load(\"items\");\n    \n    await context.sync();\n    \n    // Access the items array and iterate through each tracked change\n    const trackedChangeItems = trackedChanges.items;\n    \n    for (let i = 0; i < trackedChangeItems.length; i++) {\n        const change = trackedChangeItems[i];\n        change.load(\"text,type\");\n    }\n    \n    await context.sync();\n    \n    // Log information about each tracked change\n    trackedChangeItems.forEach((change, index) => {\n        console.log(`Tracked Change ${index + 1}: ${change.type} - \"${change.text}\"`);\n    });\n});",
          "output_code": null
        }
      ]
    }
  ],
  "methods": [
    {
      "name": "acceptAll",
      "kind": "write",
      "description": "Accepts all the tracked changes in the collection.",
      "signatures": [
        {
          "params": [],
          "returns": {
            "type": "void",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Accept all tracked changes in the document body.",
          "usage_code": "// Link to full sample: https://raw.githubusercontent.com/OfficeDev/office-js-snippets/prod/samples/word/50-document/manage-tracked-changes.yaml\n\n// Accepts all tracked changes.\nawait Word.run(async (context) => {\n  const body: Word.Body = context.document.body;\n  const trackedChanges: Word.TrackedChangeCollection = body.getTrackedChanges();\n  trackedChanges.acceptAll();\n  console.log(\"Accepted all tracked changes.\");\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "getFirst",
      "kind": "read",
      "description": "Gets the first TrackedChange in this collection. Throws an ItemNotFound error if this collection is empty.",
      "signatures": [
        {
          "params": [],
          "returns": {
            "type": "Word.TrackedChange",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Retrieve and display the text content of the first tracked change in the document body.",
          "usage_code": "// Link to full sample: https://raw.githubusercontent.com/OfficeDev/office-js-snippets/prod/samples/word/50-document/manage-tracked-changes.yaml\n\n// Gets the range of the first tracked change.\nawait Word.run(async (context) => {\n  const body: Word.Body = context.document.body;\n  const trackedChanges: Word.TrackedChangeCollection = body.getTrackedChanges();\n  const trackedChange: Word.TrackedChange = trackedChanges.getFirst();\n  await context.sync();\n\n  const range: Word.Range = trackedChange.getRange();\n  range.load();\n  await context.sync();\n\n  console.log(\"range.text: \" + range.text);\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "getFirstOrNullObject",
      "kind": "read",
      "description": "Gets the first TrackedChange in this collection. If this collection is empty, then this method will return an object with its isNullObject property set to true. For further information, see [*OrNullObject methods and properties](/en-us/office/dev/add-ins/develop/application-specific-api-model#ornullobject-methods-and-properties).",
      "signatures": [
        {
          "params": [],
          "returns": {
            "type": "Word.TrackedChange",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Check if there are any tracked changes in the document and display the text of the first tracked change, or show a message if no tracked changes exist.",
          "usage_code": "await Word.run(async (context) => {\n    const trackedChanges = context.document.getTrackedChanges();\n    const firstChange = trackedChanges.getFirstOrNullObject();\n    \n    firstChange.load(\"isNullObject, text, type\");\n    await context.sync();\n    \n    if (firstChange.isNullObject) {\n        console.log(\"No tracked changes found in the document.\");\n    } else {\n        console.log(`First tracked change: \"${firstChange.text}\" (Type: ${firstChange.type})`);\n    }\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "load",
      "kind": "load",
      "description": "Queues up a command to load the specified properties of the object. You must call context.sync() before reading the properties.",
      "signatures": [
        {
          "params": [
            {
              "name": "options",
              "type": "Word.Interfaces.TrackedChangeCollectionLoadOptions & Word.Interfaces.CollectionLoadOptions",
              "required": false,
              "description": "Provides options for which properties of the object to load."
            }
          ],
          "returns": {
            "type": "Word.TrackedChangeCollection",
            "description": null
          }
        },
        {
          "params": [
            {
              "name": "propertyNames",
              "type": "string | string[]",
              "required": false,
              "description": "A comma-delimited string or an array of strings that specify the properties to load."
            }
          ],
          "returns": {
            "type": "Word.TrackedChangeCollection",
            "description": null
          }
        },
        {
          "params": [
            {
              "name": "propertyNamesAndPaths",
              "type": "OfficeExtension.LoadOption",
              "required": false,
              "description": "propertyNamesAndPaths.select is a comma-delimited string that specifies the properties to load, and propertyNamesAndPaths.expand is a comma-delimited string that specifies the navigation properties to load."
            }
          ],
          "returns": {
            "type": "Word.TrackedChangeCollection",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Load and display the author and text of all tracked changes in the document",
          "usage_code": "await Word.run(async (context) => {\n    // Get the collection of tracked changes\n    const trackedChanges = context.document.body.trackedChanges;\n    \n    // Load specific properties of all tracked changes\n    trackedChanges.load(\"author, text, type\");\n    \n    // Synchronize to execute the load command\n    await context.sync();\n    \n    // Display information about each tracked change\n    console.log(`Found ${trackedChanges.items.length} tracked changes`);\n    trackedChanges.items.forEach((change, index) => {\n        console.log(`Change ${index + 1}:`);\n        console.log(`  Author: ${change.author}`);\n        console.log(`  Type: ${change.type}`);\n        console.log(`  Text: ${change.text}`);\n    });\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "rejectAll",
      "kind": "write",
      "description": "Rejects all the tracked changes in the collection.",
      "signatures": [
        {
          "params": [],
          "returns": {
            "type": "void",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Reject all tracked changes in the document body.",
          "usage_code": "// Link to full sample: https://raw.githubusercontent.com/OfficeDev/office-js-snippets/prod/samples/word/50-document/manage-tracked-changes.yaml\n\n// Rejects all tracked changes.\nawait Word.run(async (context) => {\n  const body: Word.Body = context.document.body;\n  const trackedChanges: Word.TrackedChangeCollection = body.getTrackedChanges();\n  trackedChanges.rejectAll();\n  console.log(\"Rejected all tracked changes.\");\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "toJSON",
      "kind": "serialize",
      "description": "Overrides the JavaScript toJSON() method in order to provide more useful output when an API object is passed to JSON.stringify(). (JSON.stringify, in turn, calls the toJSON method of the object that's passed to it.) Whereas the original Word.TrackedChangeCollection object is an API object, the toJSON method returns a plain JavaScript object (typed as Word.Interfaces.TrackedChangeCollectionData) that contains an \"items\" array with shallow copies of any loaded properties from the collection's items.",
      "signatures": [
        {
          "params": [],
          "returns": {
            "type": "Word.Interfaces.TrackedChangeCollectionData",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Export tracked changes from the document to JSON format for logging or external processing",
          "usage_code": "await Word.run(async (context) => {\n    // Get all tracked changes in the document\n    const trackedChanges = context.document.body.trackedChanges;\n    \n    // Load properties we want to export\n    trackedChanges.load(\"text, type, author, date\");\n    \n    await context.sync();\n    \n    // Convert the collection to a plain JavaScript object\n    const trackedChangesData = trackedChanges.toJSON();\n    \n    // Log or process the JSON data\n    console.log(\"Tracked Changes JSON:\", JSON.stringify(trackedChangesData, null, 2));\n    \n    // Access the items array\n    console.log(`Found ${trackedChangesData.items.length} tracked changes`);\n    trackedChangesData.items.forEach((change, index) => {\n        console.log(`Change ${index + 1}: ${change.type} by ${change.author}`);\n    });\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "track",
      "kind": "track",
      "description": "Track the object for automatic adjustment based on surrounding changes in the document. This call is a shorthand for [context.trackedObjects.add(thisObject)](/en-us/javascript/api/office/officeextension.clientrequestcontext#office-officeextension-clientrequestcontext-trackedobjects-member). If you're using this object across .sync calls and outside the sequential execution of a \".run\" batch, and get an \"InvalidObjectPath\" error when setting a property or invoking a method on the object, you need to add the object to the tracked object collection when the object was first created. If this object is part of a collection, you should also track the parent collection.",
      "signatures": [
        {
          "params": [],
          "returns": {
            "type": "Word.TrackedChangeCollection",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Track all tracked changes in the document across multiple sync calls to monitor their properties and ensure they remain valid references throughout the batch operation.",
          "usage_code": "await Word.run(async (context) => {\n    // Get all tracked changes in the document\n    const trackedChanges = context.document.body.trackedChanges;\n    trackedChanges.load(\"items\");\n    await context.sync();\n\n    // Track the collection to maintain valid references across sync calls\n    trackedChanges.track();\n\n    // Perform operations across multiple sync calls\n    console.log(`Found ${trackedChanges.items.length} tracked changes`);\n    await context.sync();\n\n    // The tracked collection remains valid for further operations\n    for (let i = 0; i < trackedChanges.items.length; i++) {\n        trackedChanges.items[i].load(\"text,type\");\n    }\n    await context.sync();\n\n    // Access properties after multiple syncs (tracking prevents InvalidObjectPath errors)\n    trackedChanges.items.forEach((change) => {\n        console.log(`Change type: ${change.type}, Text: ${change.text}`);\n    });\n\n    // Untrack when done to free resources\n    trackedChanges.untrack();\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "untrack",
      "kind": "untrack",
      "description": "Release the memory associated with this object, if it has previously been tracked. This call is shorthand for [context.trackedObjects.remove(thisObject)](/en-us/javascript/api/office/officeextension.clientrequestcontext#office-officeextension-clientrequestcontext-trackedobjects-member). Having many tracked objects slows down the host application, so please remember to free any objects you add, once you're done using them. You'll need to call context.sync() before the memory release takes effect.",
      "signatures": [
        {
          "params": [],
          "returns": {
            "type": "Word.TrackedChangeCollection",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Load tracked changes from a document, process them, then untrack the collection to free memory and improve performance.",
          "usage_code": "await Word.run(async (context) => {\n    // Get the tracked changes collection from the document\n    const trackedChanges = context.document.body.trackedChanges;\n    \n    // Load properties to work with the collection\n    trackedChanges.load(\"items\");\n    await context.sync();\n    \n    // Process the tracked changes (e.g., log count)\n    console.log(`Found ${trackedChanges.items.length} tracked changes`);\n    \n    // Untrack the collection to release memory\n    trackedChanges.untrack();\n    \n    // Sync to apply the memory release\n    await context.sync();\n    \n    console.log(\"TrackedChangeCollection memory released\");\n});",
          "output_code": null
        }
      ]
    }
  ],
  "source": {
    "urls": [
      "https://docs.microsoft.com/en-us/javascript/api/word/word.trackedchangecollection"
    ]
  }
}
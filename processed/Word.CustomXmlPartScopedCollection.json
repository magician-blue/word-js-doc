{
  "class": {
    "name": "Word.CustomXmlPartScopedCollection",
    "package": "word",
    "extends": [
      "OfficeExtension.ClientObject"
    ],
    "api_set": {
      "name": "WordApi 1.4",
      "status": null
    },
    "description": "Contains the collection of [Word.CustomXmlPart](/en-us/javascript/api/word/word.customxmlpart) objects with a specific namespace.",
    "examples": [
      {
        "description": null,
        "usage_code": "// Link to full sample: https://raw.githubusercontent.com/OfficeDev/office-js-snippets/prod/samples/word/50-document/manage-custom-xml-part-ns.yaml\n\n// Original XML: <Reviewers xmlns='http://schemas.contoso.com/review/1.0'><Reviewer>Juan</Reviewer><Reviewer>Hong</Reviewer><Reviewer>Sally</Reviewer></Reviewers>\n\n// Gets the custom XML parts with the specified namespace URI.\nawait Word.run(async (context) => {\n  const namespaceUri = \"http://schemas.contoso.com/review/1.0\";\n  console.log(`Specified namespace URI: ${namespaceUri}`);\n  const scopedCustomXmlParts: Word.CustomXmlPartScopedCollection =\n    context.document.customXmlParts.getByNamespace(namespaceUri);\n  scopedCustomXmlParts.load(\"items\");\n  await context.sync();\n\n  console.log(`Number of custom XML parts found with this namespace: ${!scopedCustomXmlParts.items ? 0 : scopedCustomXmlParts.items.length}`);\n});",
        "output_code": null
      }
    ]
  },
  "properties": [
    {
      "name": "context",
      "type": "RequestContext",
      "description": "The request context associated with the object. This connects the add-in's process to the Office host application's process.",
      "since": null,
      "examples": [
        {
          "description": "Access the request context from a CustomXmlPartScopedCollection to verify the connection between the add-in and Word before performing operations on custom XML parts with a specific namespace.",
          "usage_code": "await Word.run(async (context) => {\n    // Get custom XML parts with a specific namespace\n    const namespace = \"http://schemas.contoso.com/customer\";\n    const customXmlParts = context.document.customXmlParts.getByNamespace(namespace);\n    \n    // Access the request context from the collection\n    const requestContext = customXmlParts.context;\n    \n    // Verify the context is available and matches the Word.run context\n    if (requestContext === context) {\n        console.log(\"Request context is properly connected to Word\");\n    }\n    \n    // Use the context to load and sync the collection\n    customXmlParts.load(\"items\");\n    await context.sync();\n    \n    console.log(`Found ${customXmlParts.items.length} custom XML parts in namespace: ${namespace}`);\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "items",
      "type": "Word.CustomXmlPart[]",
      "description": "Gets the loaded child items in this collection.",
      "since": null,
      "examples": [
        {
          "description": "Retrieve all custom XML parts with a specific namespace and log their IDs to the console.",
          "usage_code": "await Word.run(async (context) => {\n    // Get custom XML parts with a specific namespace\n    const customXmlParts = context.document.customXmlParts.getByNamespace(\"http://schemas.contoso.com/customer\");\n    \n    // Load the items property to access the collection\n    customXmlParts.load(\"items\");\n    \n    await context.sync();\n    \n    // Access the items array and log each part's ID\n    console.log(`Found ${customXmlParts.items.length} custom XML parts`);\n    \n    for (let i = 0; i < customXmlParts.items.length; i++) {\n        const part = customXmlParts.items[i];\n        part.load(\"id\");\n        await context.sync();\n        console.log(`Custom XML Part ${i + 1} ID: ${part.id}`);\n    }\n});",
          "output_code": null
        }
      ]
    }
  ],
  "methods": [
    {
      "name": "getCount",
      "kind": "read",
      "description": "Gets the number of items in the collection.",
      "signatures": [
        {
          "params": [],
          "returns": {
            "type": "OfficeExtension.ClientResult<number>",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Get the count of custom XML parts with a specific namespace and display it in the console.",
          "usage_code": "await Word.run(async (context) => {\n    // Define the namespace to search for\n    const namespace = \"http://schemas.contoso.com/customer\";\n    \n    // Get custom XML parts scoped to the specific namespace\n    const customXmlParts = context.document.customXmlParts.getByNamespace(namespace);\n    \n    // Get the count of custom XML parts in this namespace\n    const count = customXmlParts.getCount();\n    \n    // Load and sync the count value\n    await context.sync();\n    \n    // Display the count\n    console.log(`Number of custom XML parts with namespace '${namespace}': ${count.value}`);\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "getItem",
      "kind": "read",
      "description": "Gets a custom XML part based on its ID.",
      "signatures": [
        {
          "params": [
            {
              "name": "id",
              "type": "string",
              "required": true,
              "description": "ID of the custom XML part to be retrieved."
            }
          ],
          "returns": {
            "type": "Word.CustomXmlPart",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Get a custom XML part with a specific ID from a scoped collection filtered by namespace and read its XML content.",
          "usage_code": "await Word.run(async (context) => {\n    // Define the namespace and the ID of the custom XML part to retrieve\n    const namespace = \"http://schemas.contoso.com/customer\";\n    const customXmlPartId = \"{12345678-1234-1234-1234-123456789012}\";\n    \n    // Get the scoped collection of custom XML parts with the specified namespace\n    const scopedCollection = context.document.customXmlParts.getByNamespace(namespace);\n    \n    // Get the specific custom XML part by its ID\n    const customXmlPart = scopedCollection.getItem(customXmlPartId);\n    \n    // Load the XML content\n    customXmlPart.load(\"xml\");\n    \n    await context.sync();\n    \n    // Use the retrieved custom XML part\n    console.log(\"Custom XML Part Content:\", customXmlPart.xml);\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "getItemOrNullObject",
      "kind": "read",
      "description": "Gets a custom XML part based on its ID. If the CustomXmlPart doesn't exist in the collection, then this method will return an object with its isNullObject property set to true. For further information, see [*OrNullObject methods and properties](/en-us/office/dev/add-ins/develop/application-specific-api-model#ornullobject-methods-and-properties).",
      "signatures": [
        {
          "params": [
            {
              "name": "id",
              "type": "string",
              "required": true,
              "description": "Required. ID of the object to be retrieved."
            }
          ],
          "returns": {
            "type": "Word.CustomXmlPart",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Check if a custom XML part with a specific ID exists in a namespace-scoped collection and read its content if found, otherwise log that it doesn't exist.",
          "usage_code": "await Word.run(async (context) => {\n    const namespace = \"http://schemas.contoso.com/customer\";\n    const customXmlParts = context.document.customXmlParts.getByNamespace(namespace);\n    const targetId = \"{12345678-1234-1234-1234-123456789012}\";\n    \n    const customXmlPart = customXmlParts.getItemOrNullObject(targetId);\n    customXmlPart.load(\"isNullObject, xml\");\n    \n    await context.sync();\n    \n    if (customXmlPart.isNullObject) {\n        console.log(`Custom XML part with ID ${targetId} not found in namespace ${namespace}`);\n    } else {\n        console.log(\"Custom XML part found:\");\n        console.log(customXmlPart.xml);\n    }\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "getOnlyItem",
      "kind": "read",
      "description": "If the collection contains exactly one item, this method returns it. Otherwise, this method produces an error.",
      "signatures": [
        {
          "params": [],
          "returns": {
            "type": "Word.CustomXmlPart",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Get the single custom XML part with a specific namespace and display its ID, assuming exactly one part exists with that namespace.",
          "usage_code": "await Word.run(async (context) => {\n    const namespace = \"http://schemas.contoso.com/customer\";\n    \n    // Get all custom XML parts with the specific namespace\n    const customXmlParts = context.document.customXmlParts.getByNamespace(namespace);\n    \n    // Get the only item (will error if collection doesn't contain exactly one item)\n    const customXmlPart = customXmlParts.getOnlyItem();\n    customXmlPart.load(\"id\");\n    \n    await context.sync();\n    \n    console.log(`Custom XML Part ID: ${customXmlPart.id}`);\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "getOnlyItemOrNullObject",
      "kind": "read",
      "description": "If the collection contains exactly one item, this method returns it. Otherwise, this method will return an object with its isNullObject property set to true. For further information, see [*OrNullObject methods and properties](/en-us/office/dev/add-ins/develop/application-specific-api-model#ornullobject-methods-and-properties).",
      "signatures": [
        {
          "params": [],
          "returns": {
            "type": "Word.CustomXmlPart",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Check if there is exactly one custom XML part with a specific namespace and retrieve its ID, or handle the case when there are zero or multiple parts.",
          "usage_code": "await Word.run(async (context) => {\n    const namespace = \"http://schemas.contoso.com/customer\";\n    const customXmlParts = context.document.customXmlParts.getByNamespace(namespace);\n    const singlePart = customXmlParts.getOnlyItemOrNullObject();\n    \n    singlePart.load(\"id, isNullObject\");\n    await context.sync();\n    \n    if (singlePart.isNullObject) {\n        console.log(\"There are zero or multiple custom XML parts with this namespace.\");\n    } else {\n        console.log(`Found exactly one custom XML part with ID: ${singlePart.id}`);\n    }\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "load",
      "kind": "load",
      "description": "Queues up a command to load the specified properties of the object. You must call context.sync() before reading the properties.",
      "signatures": [
        {
          "params": [
            {
              "name": "options",
              "type": "Word.Interfaces.CustomXmlPartScopedCollectionLoadOptions & Word.Interfaces.CollectionLoadOptions",
              "required": false,
              "description": "Provides options for which properties of the object to load."
            }
          ],
          "returns": {
            "type": "Word.CustomXmlPartScopedCollection",
            "description": null
          }
        },
        {
          "params": [
            {
              "name": "propertyNames",
              "type": "string | string[]",
              "required": false,
              "description": "A comma-delimited string or an array of strings that specify the properties to load."
            }
          ],
          "returns": {
            "type": "Word.CustomXmlPartScopedCollection",
            "description": null
          }
        },
        {
          "params": [
            {
              "name": "propertyNamesAndPaths",
              "type": "OfficeExtension.LoadOption",
              "required": false,
              "description": "propertyNamesAndPaths.select is a comma-delimited string that specifies the properties to load, and propertyNamesAndPaths.expand is a comma-delimited string that specifies the navigation properties to load."
            }
          ],
          "returns": {
            "type": "Word.CustomXmlPartScopedCollection",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Load and display the namespace URIs of all custom XML parts that match a specific namespace in the document.",
          "usage_code": "await Word.run(async (context) => {\n    const namespace = \"http://schemas.contoso.com/customer\";\n    \n    // Get custom XML parts with the specified namespace\n    const customXmlParts = context.document.customXmlParts.getByNamespace(namespace);\n    \n    // Load the namespace property of the scoped collection items\n    customXmlParts.load(\"items/namespaceUri\");\n    \n    await context.sync();\n    \n    // Display the namespace URIs\n    console.log(`Found ${customXmlParts.items.length} custom XML parts with namespace: ${namespace}`);\n    customXmlParts.items.forEach((part, index) => {\n        console.log(`Part ${index + 1} namespace: ${part.namespaceUri}`);\n    });\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "toJSON",
      "kind": "serialize",
      "description": "Overrides the JavaScript toJSON() method in order to provide more useful output when an API object is passed to JSON.stringify(). (JSON.stringify, in turn, calls the toJSON method of the object that's passed to it.) Whereas the original Word.CustomXmlPartScopedCollection object is an API object, the toJSON method returns a plain JavaScript object (typed as Word.Interfaces.CustomXmlPartScopedCollectionData) that contains an \"items\" array with shallow copies of any loaded properties from the collection's items.",
      "signatures": [
        {
          "params": [],
          "returns": {
            "type": "Word.Interfaces.CustomXmlPartScopedCollectionData",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Retrieve custom XML parts with a specific namespace and serialize them to JSON format for logging or external storage.",
          "usage_code": "await Word.run(async (context) => {\n    // Get custom XML parts with a specific namespace\n    const namespace = \"http://schemas.contoso.com/customer\";\n    const customXmlParts = context.document.customXmlParts.getByNamespace(namespace);\n    \n    // Load the properties we want to serialize\n    customXmlParts.load(\"items\");\n    \n    await context.sync();\n    \n    // Convert the collection to a plain JavaScript object\n    const jsonData = customXmlParts.toJSON();\n    \n    // Now you can use the plain object (e.g., log it, send to server, etc.)\n    console.log(\"Custom XML Parts as JSON:\", JSON.stringify(jsonData, null, 2));\n    console.log(\"Number of parts found:\", jsonData.items.length);\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "track",
      "kind": "track",
      "description": "Track the object for automatic adjustment based on surrounding changes in the document. This call is a shorthand for [context.trackedObjects.add(thisObject)](/en-us/javascript/api/office/officeextension.clientrequestcontext#office-officeextension-clientrequestcontext-trackedobjects-member). If you're using this object across .sync calls and outside the sequential execution of a \".run\" batch, and get an \"InvalidObjectPath\" error when setting a property or invoking a method on the object, you need to add the object to the tracked object collection when the object was first created. If this object is part of a collection, you should also track the parent collection.",
      "signatures": [
        {
          "params": [],
          "returns": {
            "type": "Word.CustomXmlPartScopedCollection",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Track a custom XML part with a specific namespace across multiple sync calls to safely access its properties without getting \"InvalidObjectPath\" errors.",
          "usage_code": "await Word.run(async (context) => {\n    const namespace = \"http://schemas.contoso.com/customer\";\n    \n    // Get custom XML parts with the specific namespace\n    const customXmlParts = context.document.customXmlParts.getByNamespace(namespace);\n    \n    // Track the collection to use it across multiple sync calls\n    customXmlParts.track();\n    \n    // Load the collection\n    customXmlParts.load(\"items\");\n    await context.sync();\n    \n    // Now we can safely use the collection in subsequent operations\n    console.log(`Found ${customXmlParts.items.length} custom XML parts`);\n    \n    // Perform additional operations after sync\n    if (customXmlParts.items.length > 0) {\n        const firstPart = customXmlParts.items[0];\n        firstPart.load(\"id\");\n        await context.sync();\n        \n        console.log(`First part ID: ${firstPart.id}`);\n    }\n    \n    // Untrack when done\n    customXmlParts.untrack();\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "untrack",
      "kind": "untrack",
      "description": "Release the memory associated with this object, if it has previously been tracked. This call is shorthand for [context.trackedObjects.remove(thisObject)](/en-us/javascript/api/office/officeextension.clientrequestcontext#office-officeextension-clientrequestcontext-trackedobjects-member). Having many tracked objects slows down the host application, so please remember to free any objects you add, once you're done using them. You'll need to call context.sync() before the memory release takes effect.",
      "signatures": [
        {
          "params": [],
          "returns": {
            "type": "Word.CustomXmlPartScopedCollection",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Load custom XML parts with a specific namespace, use them to perform operations, then untrack the collection to free memory.",
          "usage_code": "await Word.run(async (context) => {\n    const namespace = \"http://schemas.contoso.com/customer\";\n    \n    // Get custom XML parts with the specific namespace\n    const customXmlParts = context.document.customXmlParts.getByNamespace(namespace);\n    customXmlParts.load(\"items\");\n    \n    await context.sync();\n    \n    // Use the collection (e.g., log the count)\n    console.log(`Found ${customXmlParts.items.length} custom XML parts`);\n    \n    // Untrack the collection to release memory\n    customXmlParts.untrack();\n    \n    await context.sync();\n});",
          "output_code": null
        }
      ]
    }
  ],
  "source": {
    "urls": [
      "https://raw.githubusercontent.com/OfficeDev/office-js-snippets/prod/samples/word/50-document/manage-custom-xml-part-ns.yaml"
    ]
  }
}
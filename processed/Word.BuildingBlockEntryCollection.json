{
  "class": {
    "name": "BuildingBlockEntryCollection",
    "package": "word",
    "extends": [
      "OfficeExtension.ClientObject"
    ],
    "api_set": {
      "name": "WordApi",
      "status": "BETA (PREVIEW ONLY)"
    },
    "description": "Represents a collection of building block entries in a Word template.",
    "examples": []
  },
  "properties": [
    {
      "name": "context",
      "type": "RequestContext",
      "description": "The request context associated with the object. This connects the add-in's process to the Office host application's process.",
      "since": null,
      "examples": [
        {
          "description": "Access the building block entries collection and verify the context is properly connected before performing operations on building blocks in the template.",
          "usage_code": "await Word.run(async (context) => {\n    // Get the building block entries collection from the first gallery\n    const gallery = context.document.properties.customXmlParts.getByNamespace(\"http://schemas.microsoft.com/office/word/2010/wordml\")[0];\n    const buildingBlockEntries = context.document.buildingBlockEntries;\n    \n    // Access the context property to ensure connection to Office host\n    const requestContext = buildingBlockEntries.context;\n    \n    // Verify the context is valid by checking if it's the same as the current context\n    if (requestContext === context) {\n        console.log(\"Building block entries context is properly connected to Office host\");\n        \n        // Now safe to perform operations on the collection\n        buildingBlockEntries.load(\"items\");\n        await context.sync();\n        \n        console.log(`Found ${buildingBlockEntries.items.length} building blocks`);\n    }\n});",
          "output_code": null
        }
      ]
    }
  ],
  "methods": [
    {
      "name": "add",
      "kind": "create",
      "description": "Creates a new building block entry in a template and returns a BuildingBlock object that represents the new building block entry.",
      "signatures": [
        {
          "params": [
            {
              "name": "name",
              "type": "string",
              "required": true,
              "description": "The name of the building block."
            },
            {
              "name": "type",
              "type": "Word.BuildingBlockType",
              "required": true,
              "description": "The type of the building block."
            },
            {
              "name": "category",
              "type": "string",
              "required": true,
              "description": "The category of the building block."
            },
            {
              "name": "range",
              "type": "Word.Range",
              "required": true,
              "description": "The range to insert the building block."
            },
            {
              "name": "description",
              "type": "string",
              "required": true,
              "description": "The description of the building block."
            },
            {
              "name": "insertType",
              "type": "Word.DocPartInsertType",
              "required": true,
              "description": "How to insert the contents of the building block."
            }
          ],
          "returns": {
            "type": "Word.BuildingBlock",
            "description": null
          }
        },
        {
          "params": [
            {
              "name": "name",
              "type": "string",
              "required": true,
              "description": "The name of the building block."
            },
            {
              "name": "type",
              "type": "\"QuickParts\" | \"CoverPage\" | \"Equations\" | \"Footers\" | \"Headers\" | \"PageNumber\" | \"Tables\" | \"Watermarks\" | \"AutoText\" | \"TextBox\" | \"PageNumberTop\" | \"PageNumberBottom\" | \"PageNumberPage\" | \"TableOfContents\" | \"CustomQuickParts\" | \"CustomCoverPage\" | \"CustomEquations\" | \"CustomFooters\" | \"CustomHeaders\" | \"CustomPageNumber\" | \"CustomTables\" | \"CustomWatermarks\" | \"CustomAutoText\" | \"CustomTextBox\" | \"CustomPageNumberTop\" | \"CustomPageNumberBottom\" | \"CustomPageNumberPage\" | \"CustomTableOfContents\" | \"Custom1\" | \"Custom2\" | \"Custom3\" | \"Custom4\" | \"Custom5\" | \"Bibliography\" | \"CustomBibliography\"",
              "required": true,
              "description": "The type of the building block."
            },
            {
              "name": "category",
              "type": "string",
              "required": true,
              "description": "The category of the building block."
            },
            {
              "name": "range",
              "type": "Word.Range",
              "required": true,
              "description": "The range to insert the building block."
            },
            {
              "name": "description",
              "type": "string",
              "required": true,
              "description": "The description of the building block."
            },
            {
              "name": "insertType",
              "type": "\"Content\" | \"Paragraph\" | \"Page\"",
              "required": true,
              "description": "How to insert the contents of the building block."
            }
          ],
          "returns": {
            "type": "Word.BuildingBlock",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Create a new building block entry named \"Company Header\" that stores the selected text as a reusable AutoText block in the General category",
          "usage_code": "await Word.run(async (context) => {\n    // Get the current selection\n    const range = context.document.getSelection();\n    \n    // Get the building blocks collection from the first template\n    const template = context.document.getDefaultTemplate();\n    const buildingBlocks = template.buildingBlockEntries;\n    \n    // Create a new building block entry\n    const newBlock = buildingBlocks.add(\n        \"Company Header\",                    // name\n        Word.BuildingBlockType.autoText,     // type\n        \"General\",                           // category\n        range,                               // range\n        \"Standard company header text\",      // description\n        Word.InsertLocation.replace          // insertType\n    );\n    \n    await context.sync();\n    console.log(\"Building block created successfully\");\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "getCount",
      "kind": "read",
      "description": "Returns the number of items in the collection.",
      "signatures": [
        {
          "params": [],
          "returns": {
            "type": "OfficeExtension.ClientResult<number>",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Display the total number of available building blocks in the \"General\" gallery to the user in the console.",
          "usage_code": "await Word.run(async (context) => {\n    const template = context.document.getActiveSectionOrNullObject().body;\n    const buildingBlockEntries = context.application.buildingBlockTemplates\n        .getFirst()\n        .buildingBlockEntries;\n    \n    const count = buildingBlockEntries.getCount();\n    \n    await context.sync();\n    \n    console.log(`Total building blocks available: ${count.value}`);\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "getItemAt",
      "kind": "read",
      "description": "Returns a BuildingBlock object that represents the specified item in the collection.",
      "signatures": [
        {
          "params": [
            {
              "name": "index",
              "type": "number",
              "required": true,
              "description": "The index of the item to retrieve."
            }
          ],
          "returns": {
            "type": "Word.BuildingBlock",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Get the third building block entry from a collection and insert it into the document at the current selection.",
          "usage_code": "await Word.run(async (context) => {\n    // Get the building blocks from the first template\n    const template = context.document.getTemplate();\n    const buildingBlockEntries = template.buildingBlockEntries;\n    \n    // Get the building block at index 2 (third item)\n    const buildingBlock = buildingBlockEntries.getItemAt(2);\n    buildingBlock.load(\"name\");\n    \n    // Insert the building block at the current selection\n    const range = context.document.getSelection();\n    buildingBlock.insertContent(range, Word.InsertLocation.replace);\n    \n    await context.sync();\n    console.log(`Inserted building block: ${buildingBlock.name}`);\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "load",
      "kind": "load",
      "description": "Queues up a command to load the specified properties of the object. You must call context.sync() before reading the properties.",
      "signatures": [
        {
          "params": [
            {
              "name": "propertyNames",
              "type": "string | string[]",
              "required": false,
              "description": "A comma-delimited string or an array of strings that specify the properties to load."
            }
          ],
          "returns": {
            "type": "Word.BuildingBlockEntryCollection",
            "description": null
          }
        },
        {
          "params": [
            {
              "name": "propertyNamesAndPaths",
              "type": "{ select?: string; expand?: string; }",
              "required": false,
              "description": "propertyNamesAndPaths.select is a comma-delimited string that specifies the properties to load, and propertyNamesAndPaths.expand is a comma-delimited string that specifies the navigation properties to load."
            }
          ],
          "returns": {
            "type": "Word.BuildingBlockEntryCollection",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Load and display the names of all building block entries in the first gallery of the template",
          "usage_code": "await Word.run(async (context) => {\n    // Get the first gallery's building block entries\n    const gallery = context.document.buildingBlockGalleries.getFirst();\n    const buildingBlocks = gallery.buildingBlockEntries;\n    \n    // Load the 'name' property for all entries in the collection\n    buildingBlocks.load(\"name\");\n    \n    // Sync to execute the load command\n    await context.sync();\n    \n    // Display the names of all building block entries\n    console.log(`Found ${buildingBlocks.items.length} building blocks:`);\n    buildingBlocks.items.forEach(block => {\n        console.log(`- ${block.name}`);\n    });\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "toJSON",
      "kind": "serialize",
      "description": "Overrides the JavaScript toJSON() method in order to provide more useful output when an API object is passed to JSON.stringify(). (JSON.stringify, in turn, calls the toJSON method of the object that's passed to it.) Whereas the original Word.BuildingBlockEntryCollection object is an API object, the toJSON method returns a plain JavaScript object (typed as Word.Interfaces.BuildingBlockEntryCollectionData) that contains shallow copies of any loaded child properties from the original object.",
      "signatures": [
        {
          "params": [],
          "returns": {
            "type": "{ [key: string]: string; }",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Export building block entries from a template to JSON format for logging or external storage",
          "usage_code": "await Word.run(async (context) => {\n    // Get the building block entries collection from the first gallery\n    const gallery = context.document.getDefaultTemplate().galleries.getFirst();\n    const buildingBlocks = gallery.buildingBlockEntries;\n    \n    // Load properties needed for JSON export\n    buildingBlocks.load(\"name,type,category\");\n    \n    await context.sync();\n    \n    // Convert the collection to a plain JavaScript object\n    const buildingBlocksJSON = buildingBlocks.toJSON();\n    \n    // Log or store the JSON representation\n    console.log(JSON.stringify(buildingBlocksJSON, null, 2));\n    \n    // The JSON can now be used outside the Word context\n    // e.g., sent to a server, saved to local storage, etc.\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "track",
      "kind": "track",
      "description": "Track the object for automatic adjustment based on surrounding changes in the document. This call is a shorthand for [context.trackedObjects.add(thisObject)](/en-us/javascript/api/office/officeextension.clientrequestcontext#office-officeextension-clientrequestcontext-trackedobjects-member). If you're using this object across .sync calls and outside the sequential execution of a \".run\" batch, and get an \"InvalidObjectPath\" error when setting a property or invoking a method on the object, you need to add the object to the tracked object collection when the object was first created. If this object is part of a collection, you should also track the parent collection.",
      "signatures": [
        {
          "params": [],
          "returns": {
            "type": "Word.BuildingBlockEntryCollection",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Track a building block entry collection across multiple sync calls to prevent InvalidObjectPath errors when accessing the collection after document changes.",
          "usage_code": "await Word.run(async (context) => {\n    // Get the building block entry collection from a gallery\n    const gallery = context.document.getDefaultBuildingBlockGallery();\n    const buildingBlocks = gallery.getBuildingBlockEntries();\n    \n    // Track the collection to use it across multiple sync calls\n    buildingBlocks.track();\n    \n    // Load properties\n    buildingBlocks.load(\"items\");\n    await context.sync();\n    \n    // First sync - access the collection\n    console.log(`Found ${buildingBlocks.items.length} building blocks`);\n    \n    // Perform some document changes\n    context.document.body.insertParagraph(\"New content\", Word.InsertLocation.start);\n    await context.sync();\n    \n    // Second sync - can still safely access the tracked collection\n    for (const block of buildingBlocks.items) {\n        block.load(\"name\");\n    }\n    await context.sync();\n    \n    // Untrack when done to free memory\n    buildingBlocks.untrack();\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "untrack",
      "kind": "untrack",
      "description": "Release the memory associated with this object, if it has previously been tracked. This call is shorthand for [context.trackedObjects.remove(thisObject)](/en-us/javascript/api/office/officeextension.clientrequestcontext#office-officeextension-clientrequestcontext-trackedobjects-member). Having many tracked objects slows down the host application, so please remember to free any objects you add, once you're done using them. You'll need to call context.sync() before the memory release takes effect.",
      "signatures": [
        {
          "params": [],
          "returns": {
            "type": "Word.BuildingBlockEntryCollection",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Retrieve building block entries from a gallery, use them to get information, then untrack the collection to free memory after processing is complete.",
          "usage_code": "await Word.run(async (context) => {\n    // Get building blocks from a specific gallery\n    const template = context.document.getDefaultTemplate();\n    const gallery = template.buildingBlockGalleries.getByName(\"Quick Parts\");\n    const buildingBlocks = gallery.buildingBlockEntries;\n    \n    // Load properties to use the collection\n    buildingBlocks.load(\"items\");\n    await context.sync();\n    \n    // Process the building blocks (e.g., log their names)\n    console.log(`Found ${buildingBlocks.items.length} building blocks`);\n    buildingBlocks.items.forEach(block => {\n        console.log(block.name);\n    });\n    \n    // Untrack the collection to release memory\n    buildingBlocks.untrack();\n    await context.sync();\n    \n    console.log(\"Building block collection memory released\");\n});",
          "output_code": null
        }
      ]
    }
  ],
  "source": {
    "urls": [
      "https://docs.microsoft.com/en-us/javascript/api/word"
    ]
  }
}
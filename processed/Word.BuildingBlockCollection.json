{
  "class": {
    "name": "Word.BuildingBlockCollection",
    "package": "word",
    "extends": [
      "OfficeExtension.ClientObject"
    ],
    "api_set": {
      "name": "WordApi",
      "status": "BETA (PREVIEW ONLY)"
    },
    "description": "Represents a collection of [Word.BuildingBlock](/en-us/javascript/api/word/word.buildingblock) objects for a specific building block type and category in a template.",
    "examples": []
  },
  "properties": [
    {
      "name": "context",
      "type": "RequestContext",
      "description": "The request context associated with the object. This connects the add-in's process to the Office host application's process.",
      "since": null,
      "examples": [
        {
          "description": "Access the building block collection's request context to verify the add-in is properly connected to the Word host application before performing operations.",
          "usage_code": "await Word.run(async (context) => {\n    // Get the building blocks collection for a specific type and category\n    const template = context.document.getTemplate();\n    const buildingBlockCollection = template.getBuildingBlocksByCategory(\"General\", Word.BuildingBlockType.autoText);\n    \n    // Access the request context associated with the collection\n    const requestContext = buildingBlockCollection.context;\n    \n    // Verify the context is valid and connected\n    if (requestContext && requestContext.application) {\n        console.log(\"Building block collection is properly connected to Word application\");\n        \n        // Use the context to load and sync data\n        buildingBlockCollection.load(\"items\");\n        await context.sync();\n        \n        console.log(`Found ${buildingBlockCollection.items.length} building blocks`);\n    }\n});",
          "output_code": null
        }
      ]
    }
  ],
  "methods": [
    {
      "name": "add",
      "kind": "create",
      "description": "Creates a new building block and returns a BuildingBlock object.",
      "signatures": [
        {
          "params": [
            {
              "name": "name",
              "type": "string",
              "required": true,
              "description": "The name of the building block."
            },
            {
              "name": "range",
              "type": "Word.Range",
              "required": true,
              "description": "The range to insert the building block."
            },
            {
              "name": "description",
              "type": "string",
              "required": true,
              "description": "The description of the building block."
            },
            {
              "name": "insertType",
              "type": "Word.DocPartInsertType",
              "required": true,
              "description": "How to insert the contents of the building block."
            }
          ],
          "returns": {
            "type": "Word.BuildingBlock",
            "description": null
          }
        },
        {
          "params": [
            {
              "name": "name",
              "type": "string",
              "required": true,
              "description": "The name of the building block."
            },
            {
              "name": "range",
              "type": "Word.Range",
              "required": true,
              "description": "The range to insert the building block."
            },
            {
              "name": "description",
              "type": "string",
              "required": true,
              "description": "The description of the building block."
            },
            {
              "name": "insertType",
              "type": "\"Content\" | \"Paragraph\" | \"Page\"",
              "required": true,
              "description": "How to insert the contents of the building block."
            }
          ],
          "returns": {
            "type": "Word.BuildingBlock",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Create a new building block from the currently selected text in the document, naming it \"Company Header\" with a description for reuse",
          "usage_code": "await Word.run(async (context) => {\n    // Get the current selection\n    const selection = context.document.getSelection();\n    \n    // Get the building blocks collection for a specific type and category\n    const template = context.document.getActiveTemplate();\n    const buildingBlocks = template.getBuildingBlocksByCategory(\"General\");\n    \n    // Create a new building block from the selection\n    const newBuildingBlock = buildingBlocks.add(\n        \"Company Header\",\n        selection,\n        \"Standard company header with logo and contact info\",\n        Word.InsertLocation.replace\n    );\n    \n    // Load properties to verify creation\n    newBuildingBlock.load(\"name\");\n    \n    await context.sync();\n    console.log(`Building block created: ${newBuildingBlock.name}`);\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "getCount",
      "kind": "read",
      "description": "Returns the number of items in the collection.",
      "signatures": [
        {
          "params": [],
          "returns": {
            "type": "OfficeExtension.ClientResult<number>",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Get and display the number of AutoText building blocks available in the \"General\" category",
          "usage_code": "await Word.run(async (context) => {\n    // Get the building blocks collection for AutoText in the General category\n    const buildingBlockCollection = context.application.getTemplate()\n        .getBuildingBlocksByCategory(\"AutoText\", \"General\");\n    \n    // Get the count of building blocks in the collection\n    const count = buildingBlockCollection.getCount();\n    \n    // Load the count value\n    await context.sync();\n    \n    // Display the count\n    console.log(`Number of AutoText building blocks in General category: ${count.value}`);\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "getItemAt",
      "kind": "read",
      "description": "Returns a BuildingBlock object that represents the specified item in the collection.",
      "signatures": [
        {
          "params": [
            {
              "name": "index",
              "type": "number",
              "required": true,
              "description": "The index of the item to retrieve."
            }
          ],
          "returns": {
            "type": "Word.BuildingBlock",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Get and insert the third building block from the \"General\" category of \"Quick Parts\" type into the document at the current selection.",
          "usage_code": "await Word.run(async (context) => {\n    // Get the first template (active document's template)\n    const template = context.document.getTemplate();\n    \n    // Get the building block collection for \"Quick Parts\" type and \"General\" category\n    const buildingBlocks = template.getBuildingBlocksByCategory(\"Quick Parts\", \"General\");\n    \n    // Get the building block at index 2 (third item)\n    const buildingBlock = buildingBlocks.getItemAt(2);\n    \n    // Load the building block's name property\n    buildingBlock.load(\"name\");\n    \n    await context.sync();\n    \n    // Insert the building block at the current selection\n    const range = context.document.getSelection();\n    buildingBlock.insertContent(range, Word.InsertLocation.replace);\n    \n    await context.sync();\n    \n    console.log(`Inserted building block: ${buildingBlock.name}`);\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "load",
      "kind": "load",
      "description": "Queues up a command to load the specified properties of the object. You must call context.sync() before reading the properties.",
      "signatures": [
        {
          "params": [
            {
              "name": "propertyNames",
              "type": "string | string[]",
              "required": false,
              "description": "A comma-delimited string or an array of strings that specify the properties to load."
            }
          ],
          "returns": {
            "type": "Word.BuildingBlockCollection",
            "description": null
          }
        },
        {
          "params": [
            {
              "name": "propertyNamesAndPaths",
              "type": "{ select?: string; expand?: string; }",
              "required": false,
              "description": "propertyNamesAndPaths.select is a comma-delimited string that specifies the properties to load, and propertyNamesAndPaths.expand is a comma-delimited string that specifies the navigation properties to load."
            }
          ],
          "returns": {
            "type": "Word.BuildingBlockCollection",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Load and display the names of all building blocks in the \"General\" category of type \"AutoText\"",
          "usage_code": "await Word.run(async (context) => {\n    // Get the building blocks collection for AutoText type and General category\n    const buildingBlockCollection = context.application.getTemplate()\n        .getBuildingBlocksByType(Word.BuildingBlockType.autoText)\n        .getByCategory(\"General\");\n    \n    // Load the 'name' property for all building blocks in the collection\n    buildingBlockCollection.load(\"items/name\");\n    \n    await context.sync();\n    \n    // Display the names of the building blocks\n    buildingBlockCollection.items.forEach(block => {\n        console.log(`Building Block Name: ${block.name}`);\n    });\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "toJSON",
      "kind": "serialize",
      "description": "Overrides the JavaScript toJSON() method in order to provide more useful output when an API object is passed to JSON.stringify(). (JSON.stringify, in turn, calls the toJSON method of the object that's passed to it.) Whereas the original Word.BuildingBlockCollection object is an API object, the toJSON method returns a plain JavaScript object (typed as Word.Interfaces.BuildingBlockCollectionData) that contains shallow copies of any loaded child properties from the original object.",
      "signatures": [
        {
          "params": [],
          "returns": {
            "type": "{ [key: string]: string; }",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Serialize building blocks from a specific category to JSON format for logging or external storage",
          "usage_code": "await Word.run(async (context) => {\n    // Get building blocks from a specific type and category\n    const buildingBlockCollection = context.application.getTemplate()\n        .getBuildingBlocksByType(Word.BuildingBlockTypes.autoText)\n        .getByCategory(\"General\");\n    \n    // Load properties needed for serialization\n    buildingBlockCollection.load(\"items/name,items/type,items/category\");\n    \n    await context.sync();\n    \n    // Convert the collection to a plain JavaScript object\n    const jsonData = buildingBlockCollection.toJSON();\n    \n    // Now you can stringify it for logging or storage\n    console.log(JSON.stringify(jsonData, null, 2));\n    \n    // The jsonData object contains shallow copies of loaded properties\n    // and can be safely used outside the Word.run context\n    return jsonData;\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "track",
      "kind": "track",
      "description": "Track the object for automatic adjustment based on surrounding changes in the document. This call is a shorthand for [context.trackedObjects.add(thisObject)](/en-us/javascript/api/office/officeextension.clientrequestcontext#office-officeextension-clientrequestcontext-trackedobjects-member). If you're using this object across .sync calls and outside the sequential execution of a \".run\" batch, and get an \"InvalidObjectPath\" error when setting a property or invoking a method on the object, you need to add the object to the tracked object collection when the object was first created. If this object is part of a collection, you should also track the parent collection.",
      "signatures": [
        {
          "params": [],
          "returns": {
            "type": "Word.BuildingBlockCollection",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Track a building block collection to safely access its items across multiple sync calls when working with AutoText building blocks from the Normal template.",
          "usage_code": "await Word.run(async (context) => {\n    // Get the building block collection for AutoText in the Normal template\n    const buildingBlockCollection = context.application.getBuiltInStylesAsync()\n        .then(() => context.application.getActiveDocument().getBody())\n        .then(() => context.application.getBuiltInBuildingBlockCollections());\n    \n    // More practical example:\n    const template = context.application.getActiveDocument();\n    const buildingBlocks = template.getBuildingBlockCollections()\n        .getByType(Word.BuildingBlockType.autoText)\n        .getFirstOrNullObject()\n        .getByCategory(\"General\");\n    \n    // Track the collection for use across multiple sync calls\n    buildingBlocks.track();\n    \n    await context.sync();\n    \n    // Now safe to use the collection in subsequent operations\n    buildingBlocks.load(\"items\");\n    await context.sync();\n    \n    console.log(`Found ${buildingBlocks.items.length} AutoText building blocks`);\n    \n    // Perform additional operations with the tracked collection\n    if (buildingBlocks.items.length > 0) {\n        buildingBlocks.items[0].load(\"name\");\n        await context.sync();\n        console.log(`First building block: ${buildingBlocks.items[0].name}`);\n    }\n    \n    // Untrack when done\n    buildingBlocks.untrack();\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "untrack",
      "kind": "untrack",
      "description": "Release the memory associated with this object, if it has previously been tracked. This call is shorthand for [context.trackedObjects.remove(thisObject)](/en-us/javascript/api/office/officeextension.clientrequestcontext#office-officeextension-clientrequestcontext-trackedobjects-member). Having many tracked objects slows down the host application, so please remember to free any objects you add, once you're done using them. You'll need to call context.sync() before the memory release takes effect.",
      "signatures": [
        {
          "params": [],
          "returns": {
            "type": "Word.BuildingBlockCollection",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Load building blocks from a template, use them to get their names, then untrack the collection to free memory after processing is complete.",
          "usage_code": "await Word.run(async (context) => {\n    // Get building blocks of a specific type and category\n    const template = context.document.getDefaultTemplate();\n    const buildingBlocks = template.getBuildingBlocksByCategory(\"General\", Word.BuildingBlockType.autoText);\n    \n    // Load and track the collection\n    buildingBlocks.load(\"items\");\n    await context.sync();\n    \n    // Process the building blocks\n    console.log(`Found ${buildingBlocks.items.length} building blocks`);\n    buildingBlocks.items.forEach(block => {\n        console.log(block.name);\n    });\n    \n    // Release memory by untracking the collection when done\n    buildingBlocks.untrack();\n    await context.sync();\n});",
          "output_code": null
        }
      ]
    }
  ],
  "source": {
    "urls": [
      "/en-us/javascript/api/word",
      "/en-us/javascript/api/word/word.buildingblock",
      "/en-us/javascript/api/office/officeextension.clientobject",
      "/en-us/javascript/api/requirement-sets/word/word-api-requirement-sets",
      "/en-us/javascript/api/word/word.requestcontext",
      "/en-us/javascript/api/word/word.range",
      "/en-us/javascript/api/word/word.docpartinserttype",
      "/en-us/javascript/api/office/officeextension.clientresult",
      "/en-us/javascript/api/word/word.buildingblockcollection",
      "/en-us/javascript/api/office/officeextension.clientrequestcontext#office-officeextension-clientrequestcontext-trackedobjects-member"
    ]
  }
}
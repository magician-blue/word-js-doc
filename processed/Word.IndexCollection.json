{
  "class": {
    "name": "Word.IndexCollection",
    "package": "word",
    "extends": [
      "OfficeExtension.ClientObject"
    ],
    "api_set": {
      "name": "WordApi",
      "status": "BETA (PREVIEW ONLY)"
    },
    "description": "A collection of [Word.Index](/en-us/javascript/api/word/word.index) objects that represents all the indexes in the document.",
    "examples": []
  },
  "properties": [
    {
      "name": "context",
      "type": "RequestContext",
      "description": "The request context associated with the object. This connects the add-in's process to the Office host application's process.",
      "since": null,
      "examples": [
        {
          "description": "Access the request context from an IndexCollection to verify the connection to the Word document before performing operations on indexes.",
          "usage_code": "await Word.run(async (context) => {\n    // Get the index collection from the document\n    const indexCollection = context.document.body.indexes;\n    \n    // Access the request context associated with the collection\n    const requestContext = indexCollection.context;\n    \n    // Verify the context is valid by loading a property\n    indexCollection.load(\"items\");\n    await requestContext.sync();\n    \n    // Log confirmation that context is properly connected\n    console.log(`Connected to Word document with ${indexCollection.items.length} indexes`);\n    console.log(\"Request context is active and synchronized\");\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "items",
      "type": "Word.Index[]",
      "description": "Gets the loaded child items in this collection.",
      "since": null,
      "examples": [
        {
          "description": "Get all indexes in the document and display their titles in the console.",
          "usage_code": "await Word.run(async (context) => {\n    // Get the index collection from the document\n    const indexes = context.document.body.indexes;\n    \n    // Load the items property to access the array of Index objects\n    indexes.load(\"items\");\n    \n    await context.sync();\n    \n    // Access the loaded items array and display each index title\n    console.log(`Found ${indexes.items.length} index(es) in the document`);\n    \n    indexes.items.forEach((index, i) => {\n        index.load(\"type\");\n        console.log(`Index ${i + 1}: ${index.type}`);\n    });\n    \n    await context.sync();\n});",
          "output_code": null
        }
      ]
    }
  ],
  "methods": [
    {
      "name": "add",
      "kind": "create",
      "description": "Returns an Index object that represents a new index added to the document.",
      "signatures": [
        {
          "params": [
            {
              "name": "range",
              "type": "Word.Range",
              "required": true,
              "description": "The range where you want the index to appear. The index replaces the range, if the range is not collapsed."
            },
            {
              "name": "indexAddOptions",
              "type": "Word.IndexAddOptions",
              "required": false,
              "description": "Optional. The options for adding the index."
            }
          ],
          "returns": {
            "type": "Word.Index",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Add a new index to the document at the current selection with specific formatting options",
          "usage_code": "await Word.run(async (context) => {\n    // Get the current selection\n    const range = context.document.getSelection();\n    \n    // Define index options\n    const indexOptions = {\n        type: Word.IndexType.runIn,\n        numberOfColumns: 2,\n        letterHeadingFormat: Word.IndexLetterHeadingFormat.letter\n    };\n    \n    // Add a new index at the selection\n    const newIndex = context.document.indexes.add(range, indexOptions);\n    \n    // Load properties to verify\n    newIndex.load(\"type\");\n    \n    await context.sync();\n    \n    console.log(\"Index added successfully\");\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "getFormat",
      "kind": "read",
      "description": "Gets the IndexFormat value that represents the formatting for the indexes in the document.",
      "signatures": [
        {
          "params": [],
          "returns": {
            "type": "OfficeExtension.ClientResult<Word.IndexFormat>",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Get and display the formatting type of all indexes in the document (e.g., whether they use indented or run-in format)",
          "usage_code": "await Word.run(async (context) => {\n    // Get the index collection from the document\n    const indexes = context.document.body.indexes;\n    \n    // Get the format for the indexes\n    const indexFormat = indexes.getFormat();\n    indexFormat.load(\"type\");\n    \n    await context.sync();\n    \n    // Display the index format type\n    console.log(\"Index format type: \" + indexFormat.type);\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "getItem",
      "kind": "read",
      "description": "Gets an Index object by its index in the collection.",
      "signatures": [
        {
          "params": [
            {
              "name": "index",
              "type": "number",
              "required": true,
              "description": "A number that identifies the index location of an Index object."
            }
          ],
          "returns": {
            "type": "Word.Index",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Get the first index in the document and load its title property to display it",
          "usage_code": "await Word.run(async (context) => {\n    // Get the collection of indexes in the document\n    const indexes = context.document.body.indexes;\n    \n    // Get the first index (at position 0)\n    const firstIndex = indexes.getItem(0);\n    \n    // Load the title property\n    firstIndex.load(\"title\");\n    \n    await context.sync();\n    \n    // Display the title of the first index\n    console.log(\"First index title: \" + firstIndex.title);\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "load",
      "kind": "load",
      "description": "Queues up a command to load the specified properties of the object. You must call context.sync() before reading the properties.",
      "signatures": [
        {
          "params": [
            {
              "name": "options",
              "type": "Word.Interfaces.IndexCollectionLoadOptions & Word.Interfaces.CollectionLoadOptions",
              "required": false,
              "description": "Provides options for which properties of the object to load."
            }
          ],
          "returns": {
            "type": "Word.IndexCollection",
            "description": null
          }
        },
        {
          "params": [
            {
              "name": "propertyNames",
              "type": "string | string[]",
              "required": false,
              "description": "A comma-delimited string or an array of strings that specify the properties to load."
            }
          ],
          "returns": {
            "type": "Word.IndexCollection",
            "description": null
          }
        },
        {
          "params": [
            {
              "name": "propertyNamesAndPaths",
              "type": "OfficeExtension.LoadOption",
              "required": false,
              "description": "propertyNamesAndPaths.select is a comma-delimited string that specifies the properties to load, and propertyNamesAndPaths.expand is a comma-delimited string that specifies the navigation properties to load."
            }
          ],
          "returns": {
            "type": "Word.IndexCollection",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Load and display the count of all indexes in the document",
          "usage_code": "await Word.run(async (context) => {\n    // Get the index collection from the document\n    const indexes = context.document.body.indexes;\n    \n    // Load the count property of the index collection\n    indexes.load(\"count\");\n    \n    // Synchronize the document state\n    await context.sync();\n    \n    // Display the number of indexes in the document\n    console.log(`Total indexes in document: ${indexes.count}`);\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "markAllEntries",
      "kind": "configure",
      "description": "Inserts an [XE (Index Entry) field](https://support.microsoft.com/office/abaf7c78-6e21-418d-bf8b-f8186d2e4d08) after all instances of the text in the range.",
      "signatures": [
        {
          "params": [
            {
              "name": "range",
              "type": "Word.Range",
              "required": true,
              "description": "The range whose text is marked with an XE field throughout the document."
            },
            {
              "name": "markAllEntriesOptions",
              "type": "Word.IndexMarkAllEntriesOptions",
              "required": false,
              "description": "Optional. The options for marking all entries."
            }
          ],
          "returns": {
            "type": "void",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Mark all instances of the word \"JavaScript\" in the document as index entries with the main entry text \"Programming Languages\"",
          "usage_code": "await Word.run(async (context) => {\n    // Search for all instances of \"JavaScript\" in the document\n    const searchResults = context.document.body.search(\"JavaScript\", { matchCase: true });\n    searchResults.load(\"items\");\n    \n    await context.sync();\n    \n    if (searchResults.items.length > 0) {\n        // Get the first search result to use as the range\n        const range = searchResults.items[0];\n        \n        // Get the index collection\n        const indexes = context.document.indexes;\n        \n        // Mark all instances of \"JavaScript\" as index entries\n        indexes.markAllEntries(range, {\n            entry: \"Programming Languages\",\n            subEntry: \"JavaScript\"\n        });\n        \n        await context.sync();\n        console.log(`Marked ${searchResults.items.length} instances of \"JavaScript\" as index entries.`);\n    }\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "toJSON",
      "kind": "serialize",
      "description": "Overrides the JavaScript toJSON() method in order to provide more useful output when an API object is passed to JSON.stringify(). (JSON.stringify, in turn, calls the toJSON method of the object that's passed to it.) Whereas the original Word.IndexCollection object is an API object, the toJSON method returns a plain JavaScript object (typed as Word.Interfaces.IndexCollectionData) that contains an \"items\" array with shallow copies of any loaded properties from the collection's items.",
      "signatures": [
        {
          "params": [],
          "returns": {
            "type": "Word.Interfaces.IndexCollectionData",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Export all indexes in the document to JSON format for logging or external processing",
          "usage_code": "await Word.run(async (context) => {\n    // Get the collection of all indexes in the document\n    const indexes = context.document.body.indexes;\n    \n    // Load properties needed for the indexes\n    indexes.load(\"items\");\n    \n    await context.sync();\n    \n    // Convert the index collection to a plain JavaScript object\n    const indexData = indexes.toJSON();\n    \n    // Log the JSON representation\n    console.log(\"Index collection as JSON:\", JSON.stringify(indexData, null, 2));\n    \n    // Access the items array from the JSON object\n    console.log(`Number of indexes: ${indexData.items.length}`);\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "track",
      "kind": "track",
      "description": "Track the object for automatic adjustment based on surrounding changes in the document. This call is a shorthand for [context.trackedObjects.add(thisObject)](/en-us/javascript/api/office/officeextension.clientrequestcontext#office-officeextension-clientrequestcontext-trackedobjects-member). If you're using this object across .sync calls and outside the sequential execution of a \".run\" batch, and get an \"InvalidObjectPath\" error when setting a property or invoking a method on the object, you need to add the object to the tracked object collection when the object was first created. If this object is part of a collection, you should also track the parent collection.",
      "signatures": [
        {
          "params": [],
          "returns": {
            "type": "Word.IndexCollection",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Track all indexes in a document to monitor and update their properties across multiple sync calls without encountering InvalidObjectPath errors",
          "usage_code": "await Word.run(async (context) => {\n    // Get the index collection from the document\n    const indexes = context.document.body.indexes;\n    \n    // Load the indexes\n    indexes.load(\"items\");\n    await context.sync();\n    \n    // Track the collection to use it across multiple sync calls\n    indexes.track();\n    \n    // First sync - get initial count\n    console.log(`Found ${indexes.items.length} indexes`);\n    await context.sync();\n    \n    // Second sync - can still access the collection safely\n    // because it's being tracked\n    for (let i = 0; i < indexes.items.length; i++) {\n        indexes.items[i].load(\"type\");\n    }\n    await context.sync();\n    \n    // Log index types\n    indexes.items.forEach((index, i) => {\n        console.log(`Index ${i + 1} type: ${index.type}`);\n    });\n    \n    // Untrack when done to free up memory\n    indexes.untrack();\n});",
          "output_code": null
        }
      ]
    },
    {
      "name": "untrack",
      "kind": "untrack",
      "description": "Release the memory associated with this object, if it has previously been tracked. This call is shorthand for [context.trackedObjects.remove(thisObject)](/en-us/javascript/api/office/officeextension.clientrequestcontext#office-officeextension-clientrequestcontext-trackedobjects-member). Having many tracked objects slows down the host application, so please remember to free any objects you add, once you're done using them. You'll need to call context.sync() before the memory release takes effect.",
      "signatures": [
        {
          "params": [],
          "returns": {
            "type": "Word.IndexCollection",
            "description": null
          }
        }
      ],
      "examples": [
        {
          "description": "Load all indexes in a document, process them, then untrack the collection to free memory",
          "usage_code": "await Word.run(async (context) => {\n    // Load the indexes collection\n    const indexCollection = context.document.body.indexes;\n    indexCollection.load(\"items\");\n    \n    await context.sync();\n    \n    // Process the indexes (e.g., log count)\n    console.log(`Found ${indexCollection.items.length} indexes in the document`);\n    \n    // Untrack the collection to release memory\n    indexCollection.untrack();\n    \n    await context.sync();\n});",
          "output_code": null
        }
      ]
    }
  ],
  "source": {
    "urls": [
      "https://docs.microsoft.com/en-us/javascript/api/word"
    ]
  }
}